<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate a Renewal Epidemic Model — simulate_renewal_epidemic • epidp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a Renewal Epidemic Model — simulate_renewal_epidemic"><meta name="description" content="This function simulates an epidemic using a renewal model based on the
specified time-varying reproduction number (Rt), the serial interval distribution
characterized by a gamma distribution, and an initial number of cases."><meta property="og:description" content="This function simulates an epidemic using a renewal model based on the
specified time-varying reproduction number (Rt), the serial interval distribution
characterized by a gamma distribution, and an initial number of cases."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epidp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fitting_real_covid19_data.html">Fitting real COVID-19 case data</a></li>
    <li><a class="dropdown-item" href="../articles/fitting_synthetic_data_including_covariates.html">Fitting synthetic data including covariates</a></li>
    <li><a class="dropdown-item" href="../articles/fitting_synthetic_data_using_epidp.html">Fitting synthetic data using epidp</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate a Renewal Epidemic Model</h1>

      <div class="d-none name"><code>simulate_renewal_epidemic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates an epidemic using a renewal model based on the
specified time-varying reproduction number (Rt), the serial interval distribution
characterized by a gamma distribution, and an initial number of cases.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate_renewal_epidemic</span><span class="op">(</span><span class="va">Rt_fun</span>, <span class="va">nt</span>, <span class="va">mean_si</span>, <span class="va">sd_si</span>, <span class="va">i_0</span>, X <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-rt-fun">Rt_fun<a class="anchor" aria-label="anchor" href="#arg-rt-fun"></a></dt>
<dd><p>A function that takes a vector of time points and returns a vector
of reproduction numbers (Rt) corresponding to those time points.</p></dd>


<dt id="arg-nt">nt<a class="anchor" aria-label="anchor" href="#arg-nt"></a></dt>
<dd><p>An integer specifying the number of time points (duration of the epidemic simulation).</p></dd>


<dt id="arg-mean-si">mean_si<a class="anchor" aria-label="anchor" href="#arg-mean-si"></a></dt>
<dd><p>A numeric value representing the mean of the serial interval distribution.</p></dd>


<dt id="arg-sd-si">sd_si<a class="anchor" aria-label="anchor" href="#arg-sd-si"></a></dt>
<dd><p>A numeric value representing the standard deviation of the serial interval distribution.</p></dd>


<dt id="arg-i-">i_0<a class="anchor" aria-label="anchor" href="#arg-i-"></a></dt>
<dd><p>An integer specifying the initial number of cases at time point 1.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An optional matrix of covariates with <code>nt</code> rows.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p><dl><dt>i_t</dt>
<dd><p>A numeric vector of the incidence of new cases at each time point.</p></dd>

<dt>lambda_t</dt>
<dd><p>A numeric vector of the total infectiousness at each time point.</p></dd>

<dt>w_dist</dt>
<dd><p>A numeric vector of the discretized serial interval distribution.</p></dd>

<dt>r_t</dt>
<dd><p>A numeric vector of the reproduction number (Rt) at each time point.</p></dd>

<dt>t</dt>
<dd><p>A numeric vector of the time points from 1 to nt.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The renewal model is a common approach for simulating the spread of infectious diseases.
The total infectiousness at each time point is computed as the convolution of past incidence
with the serial interval distribution. The incidence at each time point is then simulated
as a Poisson random variable with a mean equal to the product of the total infectiousness and
the time-varying reproduction number.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">rt_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fl">1.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">simulate_renewal_epidemic</span><span class="op">(</span><span class="va">rt_fun</span>, <span class="fl">100</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       t i_t        R_t     lambda_t       w_dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1  10 1.42684414 1.000000e+01 1.202812e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2   0 1.35725613 1.202812e-02 3.121540e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3   1 1.29106196 3.121540e-01 1.171737e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4   2 1.22809613 1.172940e+00 1.943497e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5   1 1.16820117 1.977118e+00 2.092807e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6   0 1.11122733 2.273615e+00 1.731352e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7   2 1.05703213 2.191264e+00 1.200194e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8   2 1.00548007 1.917754e+00 7.330704e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9   1 0.95644223 1.583953e+00 4.071768e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10   2 0.90979599 1.380728e+00 2.100546e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   11   2 0.86542472 1.353204e+00 1.021454e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   12   2 0.82321745 1.398768e+00 4.732806e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   13   0 0.78306867 1.481441e+00 2.106387e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   14   0 0.74487796 1.595075e+00 9.060961e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   15   1 0.70854983 1.656625e+00 3.785690e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   16   1 0.67399345 1.528375e+00 1.542214e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   17   0 0.64112240 1.245436e+00 6.145378e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   18   0 0.60985449 9.893817e-01 2.401538e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   19   0 0.58011154 8.325695e-01 9.223817e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   20   0 0.55181916 6.984244e-01 3.488238e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   21   2 0.52490662 5.373851e-01 1.300919e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   22   0 0.49930663 3.722733e-01 4.790949e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   23   0 0.47495515 2.918871e-01 1.744290e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   24   0 0.45179132 3.646919e-01 6.284573e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   25   0 0.42975720 4.575370e-01 2.242704e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   26   1 0.40879769 4.527898e-01 7.933068e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   27   0 0.38886039 3.636594e-01 2.783419e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   28   0 0.36989545 2.785920e-01 9.692738e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   29   0 0.35185543 2.669968e-01 3.351808e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   30   0 0.33469524 2.771459e-01 1.151559e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   31   0 0.31837196 2.518534e-01 3.932399e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32   32   0 0.30284478 1.937908e-01 1.335243e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33   33   0 0.28807486 1.295745e-01 4.509726e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34   34   0 0.27402529 7.755453e-02 1.515565e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35   35   0 0.26066092 4.254312e-02 5.069278e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36   36   0 0.24794833 2.176758e-02 1.688649e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37   37   0 0.23585575 1.052483e-02 5.595524e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   38   0 0.22435293 4.856392e-03 1.854072e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   39   0 0.21341111 2.154664e-03 5.995204e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40   40   0 0.20300292 9.246319e-04 1.998401e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   41   0 0.19310236 3.855768e-04 6.661338e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   42   0 0.18368464 1.568343e-04 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   43   0 0.17472624 6.241584e-05 1.110223e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   44   0 0.16620474 2.436559e-05 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   45   0 0.15809884 9.349972e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   46   0 0.15038827 3.533251e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47   47   0 0.14305374 1.316840e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48   48   0 0.13607693 4.846801e-07 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49   49   0 0.12944038 1.763738e-07 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50   50   0 0.12312750 6.351817e-08 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51   51   0 0.11712250 2.265805e-08 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52   52   0 0.11141037 8.011946e-09 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53   53   0 0.10597682 2.810200e-09 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54   54   0 0.10080827 9.783184e-10 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55   55   0 0.09589179 3.382201e-10 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56   56   0 0.09121509 1.161724e-10 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57   57   0 0.08676648 3.966261e-11 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58   58   0 0.08253483 1.346467e-11 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59   59   0 0.07850956 4.546918e-12 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60   60   0 0.07468060 1.527556e-12 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61   61   0 0.07103839 5.109246e-13 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62   62   0 0.06757380 1.701972e-13 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63   63   0 0.06427819 5.639933e-14 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64   64   0 0.06114331 1.876277e-14 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65   65   0 0.05816131 5.995204e-15 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66   66   0 0.05532475 1.998401e-15 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67   67   0 0.05262653 6.661338e-16 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68   68   0 0.05005990 2.220446e-16 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69   69   0 0.04761845 1.110223e-16 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70   70   0 0.04529608 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71   71   0 0.04308696 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72   72   0 0.04098558 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73   73   0 0.03898669 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74   74   0 0.03708529 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75   75   0 0.03527662 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76   76   0 0.03355616 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77   77   0 0.03191960 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78   78   0 0.03036287 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79   79   0 0.02888205 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80   80   0 0.02747346 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81   81   0 0.02613356 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82   82   0 0.02485901 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83   83   0 0.02364662 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84   84   0 0.02249337 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85   85   0 0.02139635 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86   86   0 0.02035284 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87   87   0 0.01936022 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88   88   0 0.01841601 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89   89   0 0.01751785 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90   90   0 0.01666349 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91   91   0 0.01585081 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92   92   0 0.01507775 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93   93   0 0.01434240 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94   94   0 0.01364292 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95   95   0 0.01297754 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96   96   0 0.01234462 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97   97   0 0.01174257 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98   98   0 0.01116987 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99   99   0 0.01062511 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 100   0 0.01010692 0.000000e+00 0.000000e+00</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Lambert, Kris Parag.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

