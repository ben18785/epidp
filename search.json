[{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to EpiDP","title":"Contributing to EpiDP","text":"love input! want make contributing project easy transparent possible, whether ’s: Reporting bug Discussing current state code Submitting fix Proposing new features Becoming maintainer","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"we-develop-with-github","dir":"","previous_headings":"","what":"We Develop with Github","title":"Contributing to EpiDP","text":"use github host code, track issues feature requests, well accept pull requests.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"we-use-github-flow-so-all-code-changes-happen-through-pull-requests","dir":"","previous_headings":"","what":"We Use Github Flow, So All Code Changes Happen Through Pull Requests","title":"Contributing to EpiDP","text":"Pull requests best way propose changes codebase (use Github Flow). actively welcome pull requests: Fork repo create branch main. ’ve added code tested, add tests. ’ve changed APIs, update documentation. Ensure test suite passes. Make sure code lints. Issue pull request!","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"any-contributions-you-make-will-be-under-the-mit-software-license","dir":"","previous_headings":"","what":"Any contributions you make will be under the MIT Software License","title":"Contributing to EpiDP","text":"short, submit code changes, submissions understood MIT License covers project. Feel free contact maintainers ’s concern.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"report-bugs-using-githubs-issues","dir":"","previous_headings":"","what":"Report bugs using Github’s issues","title":"Contributing to EpiDP","text":"use GitHub issues track public bugs. Report bug opening new issue; ’s easy!","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"write-bug-reports-with-detail-background-and-sample-code","dir":"","previous_headings":"","what":"Write bug reports with detail, background, and sample code","title":"Contributing to EpiDP","text":"example bug report wrote, think ’s bad model. ’s another example Craig Hockenberry, app developer greatly respect. Great Bug Reports tend : quick summary /background specific! Give sample code can. stackoverflow question includes sample code anyone base R setup can run reproduce seeing expected happen actually happens Notes (possibly including think might happening, stuff tried didn’t work) People love thorough bug reports. ’m even kidding.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"use-a-consistent-coding-style","dir":"","previous_headings":"","what":"Use a Consistent Coding Style","title":"Contributing to EpiDP","text":"’m borrowing Facebook’s Guidelines 2 spaces indentation rather tabs can try running npm run lint style unification","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Contributing to EpiDP","text":"contributing, agree contributions licensed MIT License.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Contributing to EpiDP","text":"document adapted open-source contribution guidelines Facebook’s Draft","code":""},{"path":"https://ben18785.github.io/epidp/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 epidp authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ben18785.github.io/epidp/articles/fitting_real_covid19_data.html","id":"estimating-r_t-for-bogota-using-only-the-case-data","dir":"Articles","previous_headings":"","what":"Estimating RtR_t for Bogota using only the case data","title":"Fitting real COVID-19 case data","text":"first load COVID-19 data Colombia graph . first estimate RtR_t Bogota using case data using optimisation give us quick set estimates. now fit using fully Bayesian framework outputs uncertainty.","code":"# load data data(\"covid_colombia_cases_deaths_mobility\")  # plot covid_colombia_cases_deaths_mobility %>%   pivot_longer(c(cases, deaths)) %>%   ggplot(aes(x = date, y = value)) +   geom_line() +   facet_grid(vars(name), vars(city),     scales = \"free\"   ) +   xlab(\"Date\") +   ylab(\"Count\") df_bogota <- covid_colombia_cases_deaths_mobility %>%   filter(city == \"Bogota\")  # generate serial interval for COVID-19 based on reasonable mean, sd mean_si <- 6.5 sd_si <- 4.03 w <- generate_vector_serial(nrow(df_bogota), mean_si, sd_si)  # fit using optimisation fit <- fit_epifilter(   N = nrow(df_bogota),   C = df_bogota$cases,   w = w,   is_sampling = FALSE,   as_vector = FALSE )  # plot R <- fit$par$R df_bogota %>%   mutate(Rt = R) %>%   select(date, Rt, cases) %>%   filter(date >= as.Date(\"2020-04-01\")) %>%   pivot_longer(-date) %>%   ggplot(aes(x = date, y = value)) +   geom_line() +   scale_color_brewer(\"R_t\", palette = \"Dark2\") +   ylab(\"R_t\") +   facet_grid(vars(name), scales = \"free\") fit <- fit_epifilter(   N = nrow(df_bogota),   C = df_bogota$cases,   w = w,   is_sampling = TRUE,   iter = 50,   chains = 1 # as CRAN does not allow multiple cores ) #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.015156 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 151.56 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 3 #> Chain 1:            adapt_window = 20 #> Chain 1:            term_buffer = 2 #> Chain 1:  #> Chain 1: Iteration:  1 / 50 [  2%]  (Warmup) #> Chain 1: Iteration:  5 / 50 [ 10%]  (Warmup) #> Chain 1: Iteration: 10 / 50 [ 20%]  (Warmup) #> Chain 1: Iteration: 15 / 50 [ 30%]  (Warmup) #> Chain 1: Iteration: 20 / 50 [ 40%]  (Warmup) #> Chain 1: Iteration: 25 / 50 [ 50%]  (Warmup) #> Chain 1: Iteration: 26 / 50 [ 52%]  (Sampling) #> Chain 1: Iteration: 30 / 50 [ 60%]  (Sampling) #> Chain 1: Iteration: 35 / 50 [ 70%]  (Sampling) #> Chain 1: Iteration: 40 / 50 [ 80%]  (Sampling) #> Chain 1: Iteration: 45 / 50 [ 90%]  (Sampling) #> Chain 1: Iteration: 50 / 50 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 16.393 seconds (Warm-up) #> Chain 1:                22.072 seconds (Sampling) #> Chain 1:                38.465 seconds (Total) #> Chain 1: #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # extract posterior quantiles R_draws <- rstan::extract(fit, \"R\")[[1]] lower <- apply(R_draws, 2, function(x) quantile(x, 0.025)) middle <- apply(R_draws, 2, function(x) quantile(x, 0.5)) upper <- apply(R_draws, 2, function(x) quantile(x, 0.975))  # plot df_bogota %>%   mutate(     lower = lower,     middle = middle,     upper = upper   ) %>%   select(date, lower, middle, upper) %>%   filter(date >= as.Date(\"2020-04-01\")) %>%   ggplot(aes(x = date)) +   geom_ribbon(aes(ymin = lower, ymax = upper), fill = \"blue\", alpha = 0.6) +   geom_line(aes(y = middle), colour = \"blue\") +   geom_hline(yintercept = 1, linetype = 2, colour = \"orange\") +   xlab(\"Date\") +   ylab(\"R_t\")"},{"path":"https://ben18785.github.io/epidp/articles/fitting_real_covid19_data.html","id":"probing-the-drivers-of-r_t-using-mobility-data","dir":"Articles","previous_headings":"","what":"Probing the drivers of RtR_t using mobility data","title":"Fitting real COVID-19 case data","text":"assume relationship workplace mobility mtm_t RtR_t form: log(Rt)=α+βmt+ϵt, \\log(R_t) = \\alpha + \\beta m_t + \\epsilon_t, ϵt\\epsilon_t represents components RtR_t unrelated workplace mobility. now fit model using epidp. negative association probably result individuals responding COVID-19 pandemic conditions governmental policy.","code":"X <- tibble(   cons = rep(1, nrow(df_bogota)),   m = df_bogota$workplaces ) %>%   mutate(     m = scale(m)[, 1]   ) %>%   as.matrix()  fit <- fit_epifilter_covariates(   N = nrow(df_bogota),   C = df_bogota$cases,   w = w,   X = X,   is_sampling = TRUE,   iter = 50, # probably too few iterations   chains = 1 # as CRAN does not allow multiple cores; should run with more cores ) #>  #> SAMPLING FOR MODEL 'epifilter_covariates' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.015605 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 156.05 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 3 #> Chain 1:            adapt_window = 20 #> Chain 1:            term_buffer = 2 #> Chain 1:  #> Chain 1: Iteration:  1 / 50 [  2%]  (Warmup) #> Chain 1: Iteration:  5 / 50 [ 10%]  (Warmup) #> Chain 1: Iteration: 10 / 50 [ 20%]  (Warmup) #> Chain 1: Iteration: 15 / 50 [ 30%]  (Warmup) #> Chain 1: Iteration: 20 / 50 [ 40%]  (Warmup) #> Chain 1: Iteration: 25 / 50 [ 50%]  (Warmup) #> Chain 1: Iteration: 26 / 50 [ 52%]  (Sampling) #> Chain 1: Iteration: 30 / 50 [ 60%]  (Sampling) #> Chain 1: Iteration: 35 / 50 [ 70%]  (Sampling) #> Chain 1: Iteration: 40 / 50 [ 80%]  (Sampling) #> Chain 1: Iteration: 45 / 50 [ 90%]  (Sampling) #> Chain 1: Iteration: 50 / 50 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.881 seconds (Warm-up) #> Chain 1:                55.894 seconds (Sampling) #> Chain 1:                61.775 seconds (Total) #> Chain 1: #> Warning: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See #> https://mc-stan.org/misc/warnings.html#bfmi-low #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  print(fit, \"beta[2]\") #> Inference for Stan model: epifilter_covariates. #> 1 chains, each with iter=50; warmup=25; thin=1;  #> post-warmup draws per chain=25, total post-warmup draws=25. #>  #>          mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat #> beta[2] -0.06    0.01 0.01 -0.08 -0.07 -0.05 -0.05 -0.04     4 1.47 #>  #> Samples were drawn using NUTS(diag_e) at Fri Oct 25 15:42:54 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://ben18785.github.io/epidp/articles/fitting_synthetic_data_including_covariates.html","id":"added-gaussian-noise-around-a-sinusoidal-covariate-driven-mean-r_t","dir":"Articles","previous_headings":"","what":"Added Gaussian noise around a sinusoidal covariate-driven mean RtR_t","title":"Fitting synthetic data including covariates","text":"first try estimate RtR_t without covariate information. now use Stan version EpiFilter estimate RtR_t profile. now overlay estimated RtR_t versus actual values. estimated RtR_t values coincide reasonably true values.","code":"# define sinusoidal Rt with noise rt_fun <- function(t, x) {   x[1] * exp(x[2]) } nt <- 200 t <- 1:nt f <- 1.3 + 1.2 * sin(4 * (pi / 180) * t) g <- vector(length = nt) g[1] <- rnorm(1, 0, 1) rho <- 0.8 for (i in 2:length(g)) {   g[i] <- rho * g[i - 1] + rnorm(1, 0, 0.1) } X <- matrix(c(f, g), nrow = length(f), ncol = 2)  # simulation parameters mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0, X)  # plot epidemic_df %>%   mutate(f = f) %>%   select(-c(w_dist, lambda_t)) %>%   pivot_longer(c(R_t, f)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / 1000, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\", colour = \"Variable\") +   theme_minimal() # fit model fit <- fit_epifilter(   N = length(epidemic_df$i_t),   C = epidemic_df$i_t,   w = epidemic_df$w_dist,   iter = 200,   chains = 1 # to pass CRAN ) #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.001928 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 19.28 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 15 #> Chain 1:            adapt_window = 75 #> Chain 1:            term_buffer = 10 #> Chain 1:  #> Chain 1: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 1: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 1: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 1: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 1: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 1: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 1: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 1: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 1: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 1: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 1: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 1: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 15.131 seconds (Warm-up) #> Chain 1:                13.7 seconds (Sampling) #> Chain 1:                28.831 seconds (Total) #> Chain 1: #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # look at MCMC summaries print(fit, c(\"sigma\", \"R\")) #> Inference for Stan model: epifilter. #> 1 chains, each with iter=200; warmup=100; thin=1;  #> post-warmup draws per chain=100, total post-warmup draws=100. #>  #>        mean se_mean   sd 2.5%  25%  50%  75% 97.5% n_eff Rhat #> sigma  0.18    0.00 0.02 0.15 0.17 0.18 0.19  0.22    18 1.02 #> R[1]   1.09    0.06 0.43 0.44 0.77 1.05 1.35  1.99    56 1.00 #> R[2]   1.11    0.04 0.40 0.48 0.81 1.08 1.34  1.94    88 1.00 #> R[3]   1.11    0.04 0.36 0.51 0.85 1.06 1.36  1.90    83 0.99 #> R[4]   1.07    0.04 0.34 0.54 0.81 1.06 1.27  1.96    85 1.00 #> R[5]   1.04    0.03 0.29 0.62 0.81 1.04 1.22  1.75    77 1.03 #> R[6]   1.06    0.03 0.29 0.62 0.83 1.02 1.26  1.71    69 1.03 #> R[7]   1.06    0.03 0.28 0.62 0.87 1.03 1.25  1.62    83 1.04 #> R[8]   1.07    0.03 0.28 0.56 0.89 1.05 1.27  1.62    91 1.05 #> R[9]   1.10    0.03 0.27 0.62 0.89 1.11 1.28  1.64    74 1.03 #> R[10]  1.16    0.03 0.28 0.72 0.94 1.11 1.37  1.67    62 1.02 #> R[11]  1.26    0.03 0.29 0.77 1.06 1.20 1.45  1.91    93 0.99 #> R[12]  1.36    0.03 0.30 0.75 1.14 1.38 1.59  1.87    83 0.99 #> R[13]  1.49    0.03 0.33 1.00 1.23 1.50 1.69  2.16   101 1.01 #> R[14]  1.50    0.04 0.34 0.98 1.25 1.47 1.71  2.23    69 1.01 #> R[15]  1.53    0.04 0.35 0.93 1.28 1.50 1.79  2.22    66 1.00 #> R[16]  1.58    0.03 0.37 0.94 1.34 1.58 1.78  2.44   121 0.99 #> R[17]  1.62    0.03 0.34 1.01 1.40 1.65 1.80  2.37   104 1.00 #> R[18]  1.74    0.03 0.37 1.06 1.51 1.66 1.99  2.47   182 0.99 #> R[19]  1.82    0.03 0.38 1.19 1.56 1.76 2.04  2.66   160 0.99 #> R[20]  2.03    0.03 0.37 1.32 1.79 2.04 2.28  2.74   189 1.00 #> R[21]  2.07    0.04 0.38 1.35 1.81 2.09 2.33  2.79   120 1.00 #> R[22]  2.01    0.03 0.38 1.28 1.78 1.99 2.25  2.73   128 1.00 #> R[23]  1.98    0.03 0.31 1.43 1.77 1.96 2.15  2.70   153 0.99 #> R[24]  2.04    0.03 0.32 1.53 1.83 1.96 2.19  2.78   150 1.00 #> R[25]  2.18    0.03 0.36 1.68 1.91 2.13 2.40  3.01   163 0.99 #> R[26]  2.18    0.03 0.36 1.60 1.88 2.19 2.42  2.84   139 1.00 #> R[27]  2.06    0.03 0.33 1.47 1.80 2.04 2.32  2.68   138 1.00 #> R[28]  2.05    0.03 0.31 1.40 1.86 2.03 2.26  2.59   150 0.99 #> R[29]  1.98    0.02 0.30 1.48 1.76 1.96 2.17  2.59   200 0.99 #> R[30]  1.98    0.03 0.29 1.39 1.79 1.96 2.18  2.54   124 0.99 #> R[31]  1.96    0.03 0.25 1.55 1.78 1.96 2.07  2.52    81 1.02 #> R[32]  2.02    0.02 0.24 1.56 1.83 2.04 2.16  2.54   121 1.00 #> R[33]  2.00    0.03 0.24 1.63 1.84 1.95 2.16  2.54    90 1.01 #> R[34]  1.97    0.02 0.23 1.62 1.81 1.95 2.11  2.45    91 0.99 #> R[35]  1.97    0.02 0.24 1.60 1.81 1.93 2.12  2.47   103 0.99 #> R[36]  1.78    0.02 0.23 1.45 1.61 1.79 1.91  2.37   137 0.99 #> R[37]  1.72    0.02 0.20 1.42 1.55 1.69 1.84  2.10    94 0.99 #> R[38]  1.57    0.01 0.17 1.28 1.44 1.57 1.69  1.90   184 0.99 #> R[39]  1.58    0.02 0.17 1.30 1.48 1.57 1.69  1.94   116 0.99 #> R[40]  1.46    0.01 0.16 1.12 1.36 1.46 1.56  1.74   112 0.99 #> R[41]  1.45    0.01 0.16 1.13 1.37 1.47 1.56  1.74   133 0.99 #> R[42]  1.39    0.01 0.15 1.12 1.28 1.38 1.50  1.67   117 0.99 #> R[43]  1.21    0.01 0.15 0.95 1.11 1.21 1.31  1.49   117 0.99 #> R[44]  1.22    0.01 0.15 0.95 1.11 1.20 1.30  1.52   181 0.99 #> R[45]  1.19    0.01 0.11 1.01 1.11 1.18 1.25  1.43   117 0.99 #> R[46]  1.25    0.01 0.14 1.00 1.13 1.24 1.34  1.54   149 1.00 #> R[47]  1.23    0.01 0.14 0.98 1.14 1.23 1.32  1.50   101 1.00 #> R[48]  1.37    0.02 0.16 1.10 1.26 1.37 1.46  1.75    70 0.99 #> R[49]  1.33    0.02 0.15 1.10 1.23 1.31 1.43  1.62    77 0.99 #> R[50]  1.08    0.01 0.12 0.89 0.99 1.07 1.16  1.34   112 0.99 #> R[51]  0.92    0.01 0.12 0.66 0.85 0.92 1.00  1.13   129 0.99 #> R[52]  0.79    0.01 0.11 0.61 0.72 0.80 0.84  1.04    82 0.99 #> R[53]  0.69    0.01 0.10 0.52 0.62 0.68 0.75  0.86    92 0.99 #> R[54]  0.59    0.01 0.09 0.45 0.54 0.58 0.64  0.76   139 0.99 #> R[55]  0.53    0.01 0.08 0.38 0.47 0.52 0.58  0.70    82 1.06 #> R[56]  0.58    0.01 0.09 0.39 0.53 0.58 0.63  0.77   200 0.99 #> R[57]  0.45    0.01 0.07 0.31 0.41 0.46 0.50  0.59   110 0.99 #> R[58]  0.36    0.01 0.08 0.23 0.30 0.35 0.42  0.52    99 0.99 #> R[59]  0.32    0.01 0.08 0.19 0.25 0.31 0.37  0.47   187 0.99 #> R[60]  0.34    0.01 0.08 0.18 0.29 0.33 0.39  0.52   199 0.99 #> R[61]  0.28    0.01 0.07 0.17 0.23 0.28 0.32  0.44   127 1.01 #> R[62]  0.20    0.01 0.06 0.11 0.16 0.20 0.24  0.34   119 0.99 #> R[63]  0.15    0.01 0.05 0.07 0.11 0.14 0.18  0.27    97 1.00 #> R[64]  0.13    0.01 0.06 0.05 0.10 0.12 0.17  0.25   103 1.00 #> R[65]  0.11    0.01 0.06 0.04 0.06 0.10 0.14  0.23    17 1.14 #> R[66]  0.09    0.01 0.06 0.02 0.05 0.08 0.12  0.22    30 1.09 #> R[67]  0.09    0.01 0.05 0.02 0.06 0.09 0.12  0.21    59 1.00 #> R[68]  0.12    0.01 0.06 0.03 0.07 0.12 0.15  0.26    67 1.01 #> R[69]  0.16    0.01 0.08 0.04 0.11 0.15 0.21  0.32    76 1.01 #> R[70]  0.17    0.02 0.10 0.04 0.10 0.16 0.22  0.39    36 1.01 #> R[71]  0.17    0.02 0.10 0.03 0.10 0.14 0.22  0.45    35 0.99 #> R[72]  0.19    0.02 0.12 0.02 0.10 0.17 0.27  0.48    31 0.99 #> R[73]  0.24    0.02 0.12 0.09 0.15 0.23 0.30  0.54    30 0.99 #> R[74]  0.26    0.02 0.13 0.06 0.16 0.24 0.31  0.57    29 0.99 #> R[75]  0.29    0.02 0.13 0.09 0.18 0.29 0.38  0.56    30 1.00 #> R[76]  0.32    0.02 0.14 0.14 0.22 0.29 0.40  0.65    39 0.99 #> R[77]  0.36    0.02 0.15 0.14 0.24 0.35 0.43  0.67    56 1.00 #> R[78]  0.42    0.03 0.20 0.15 0.28 0.40 0.50  0.87    58 1.00 #> R[79]  0.48    0.03 0.23 0.19 0.31 0.43 0.60  0.98    64 1.01 #> R[80]  0.53    0.04 0.26 0.18 0.34 0.48 0.67  1.05    45 1.05 #> R[81]  0.56    0.04 0.27 0.20 0.36 0.51 0.73  1.10    39 1.09 #> R[82]  0.64    0.05 0.31 0.22 0.44 0.58 0.81  1.29    40 1.14 #> R[83]  0.70    0.06 0.34 0.25 0.45 0.63 0.88  1.53    33 1.17 #> R[84]  0.78    0.07 0.36 0.33 0.51 0.68 0.99  1.65    27 1.22 #> R[85]  0.81    0.08 0.38 0.31 0.53 0.75 1.02  1.70    24 1.25 #> R[86]  0.87    0.08 0.41 0.25 0.51 0.83 1.12  1.79    24 1.20 #> R[87]  0.94    0.08 0.46 0.33 0.58 0.85 1.22  2.10    30 1.14 #> R[88]  1.01    0.09 0.48 0.33 0.66 0.90 1.29  2.25    29 1.12 #> R[89]  1.09    0.09 0.47 0.34 0.73 1.04 1.37  2.15    28 1.11 #> R[90]  1.16    0.08 0.46 0.42 0.80 1.14 1.45  2.09    30 1.12 #> R[91]  1.28    0.09 0.47 0.41 0.95 1.25 1.59  2.27    25 1.12 #> R[92]  1.39    0.10 0.49 0.48 1.03 1.30 1.72  2.45    27 1.15 #> R[93]  1.48    0.08 0.48 0.62 1.14 1.41 1.81  2.54    33 1.11 #> R[94]  1.63    0.09 0.55 0.70 1.18 1.59 1.94  2.82    41 1.07 #> R[95]  1.77    0.08 0.52 0.91 1.38 1.75 2.04  2.93    46 1.07 #> R[96]  1.85    0.09 0.55 0.89 1.45 1.82 2.20  2.99    35 1.11 #> R[97]  1.93    0.09 0.54 1.05 1.52 1.90 2.22  2.95    34 1.10 #> R[98]  2.01    0.08 0.54 1.19 1.59 1.93 2.40  3.16    49 1.04 #> R[99]  2.12    0.08 0.56 1.22 1.76 2.02 2.49  3.34    51 1.05 #> R[100] 2.20    0.07 0.56 1.31 1.83 2.12 2.46  3.55    60 1.05 #> R[101] 2.28    0.07 0.55 1.42 1.87 2.20 2.68  3.42    62 1.05 #> R[102] 2.38    0.07 0.54 1.53 1.98 2.35 2.67  3.71    56 1.02 #> R[103] 2.42    0.06 0.50 1.58 2.07 2.42 2.77  3.66    70 1.02 #> R[104] 2.52    0.06 0.49 1.67 2.17 2.50 2.82  3.67    65 1.01 #> R[105] 2.48    0.05 0.46 1.65 2.15 2.46 2.75  3.55    81 0.99 #> R[106] 2.49    0.05 0.46 1.68 2.16 2.44 2.78  3.44    83 0.99 #> R[107] 2.45    0.04 0.44 1.73 2.14 2.40 2.70  3.33   115 1.01 #> R[108] 2.45    0.04 0.38 1.71 2.23 2.46 2.64  3.31    77 1.02 #> R[109] 2.41    0.04 0.37 1.85 2.14 2.34 2.64  3.23    71 1.01 #> R[110] 2.42    0.03 0.32 1.86 2.22 2.41 2.63  3.06    94 1.00 #> R[111] 2.44    0.03 0.32 1.75 2.26 2.47 2.62  2.99   110 0.99 #> R[112] 2.47    0.03 0.38 1.68 2.24 2.47 2.72  3.15   155 0.99 #> R[113] 2.51    0.03 0.35 1.96 2.26 2.48 2.75  3.27   127 1.00 #> R[114] 2.55    0.03 0.32 2.04 2.32 2.52 2.76  3.20   124 0.99 #> R[115] 2.73    0.03 0.37 2.06 2.46 2.70 2.96  3.45   115 0.99 #> R[116] 2.77    0.04 0.39 2.08 2.46 2.77 3.02  3.60   114 1.01 #> R[117] 2.75    0.03 0.39 2.15 2.42 2.72 3.05  3.40   148 0.99 #> R[118] 2.73    0.03 0.35 2.12 2.43 2.75 2.98  3.40    99 0.99 #> R[119] 2.69    0.03 0.32 2.10 2.45 2.71 2.90  3.33   111 0.99 #> R[120] 2.68    0.03 0.32 2.11 2.43 2.71 2.86  3.28    90 1.02 #> R[121] 2.85    0.03 0.27 2.37 2.63 2.82 3.04  3.40   101 0.99 #> R[122] 2.75    0.03 0.26 2.19 2.55 2.75 2.93  3.21   109 0.99 #> R[123] 2.54    0.02 0.23 2.18 2.35 2.54 2.67  3.03   111 1.00 #> R[124] 2.56    0.03 0.25 2.13 2.39 2.54 2.69  3.07    79 0.99 #> R[125] 2.44    0.02 0.19 2.12 2.31 2.44 2.60  2.81    98 0.99 #> R[126] 2.43    0.02 0.23 2.03 2.26 2.41 2.61  2.85   113 1.01 #> R[127] 2.45    0.02 0.20 2.09 2.33 2.42 2.60  2.78   120 1.00 #> R[128] 2.24    0.02 0.17 1.89 2.12 2.24 2.36  2.54    75 1.00 #> R[129] 1.94    0.02 0.18 1.56 1.83 1.95 2.06  2.31    90 1.00 #> R[130] 1.93    0.02 0.19 1.60 1.79 1.91 2.06  2.30    68 1.00 #> R[131] 1.80    0.02 0.15 1.53 1.72 1.79 1.88  2.10    72 1.01 #> R[132] 1.62    0.02 0.14 1.39 1.53 1.61 1.70  1.88    52 1.03 #> R[133] 1.54    0.01 0.11 1.31 1.47 1.54 1.61  1.75   129 1.01 #> R[134] 1.35    0.01 0.12 1.16 1.28 1.35 1.43  1.57    94 0.99 #> R[135] 1.12    0.01 0.10 0.93 1.04 1.11 1.19  1.33   106 0.99 #> R[136] 1.05    0.01 0.09 0.90 0.99 1.04 1.11  1.26   137 0.99 #> R[137] 1.00    0.01 0.08 0.84 0.95 0.99 1.05  1.16   159 1.00 #> R[138] 0.83    0.01 0.08 0.65 0.77 0.82 0.89  0.98    89 0.99 #> R[139] 0.79    0.01 0.07 0.67 0.75 0.79 0.82  0.92    87 0.99 #> R[140] 0.86    0.01 0.08 0.70 0.80 0.85 0.92  1.02    94 1.00 #> R[141] 0.81    0.01 0.07 0.69 0.76 0.80 0.85  0.93   133 0.99 #> R[142] 0.73    0.01 0.08 0.59 0.67 0.73 0.79  0.86    90 1.03 #> R[143] 0.73    0.01 0.07 0.62 0.68 0.73 0.78  0.86   116 0.99 #> R[144] 0.71    0.01 0.08 0.56 0.65 0.70 0.75  0.87    74 1.03 #> R[145] 0.67    0.01 0.08 0.56 0.62 0.67 0.73  0.84    48 1.03 #> R[146] 0.64    0.01 0.07 0.52 0.59 0.63 0.67  0.77   102 0.99 #> R[147] 0.48    0.01 0.05 0.37 0.45 0.48 0.51  0.58    97 0.99 #> R[148] 0.38    0.01 0.06 0.26 0.35 0.38 0.41  0.48   104 1.00 #> R[149] 0.27    0.01 0.05 0.17 0.24 0.27 0.30  0.37    96 1.01 #> R[150] 0.29    0.00 0.05 0.20 0.26 0.29 0.33  0.40   142 0.99 #> R[151] 0.29    0.00 0.06 0.20 0.25 0.28 0.33  0.41   142 0.99 #> R[152] 0.23    0.01 0.05 0.14 0.19 0.23 0.26  0.32    82 0.99 #> R[153] 0.17    0.00 0.04 0.10 0.14 0.17 0.20  0.25   123 0.99 #> R[154] 0.19    0.00 0.05 0.11 0.16 0.18 0.20  0.33   117 0.99 #> R[155] 0.13    0.00 0.05 0.05 0.09 0.12 0.16  0.24   176 1.01 #> R[156] 0.11    0.00 0.05 0.04 0.08 0.10 0.13  0.23   142 1.00 #> R[157] 0.14    0.00 0.05 0.05 0.10 0.14 0.16  0.23   105 1.01 #> R[158] 0.14    0.01 0.05 0.06 0.10 0.13 0.16  0.24   107 1.07 #> R[159] 0.15    0.01 0.06 0.04 0.11 0.13 0.18  0.26    84 1.03 #> R[160] 0.17    0.01 0.06 0.08 0.13 0.17 0.22  0.30   113 1.04 #> R[161] 0.16    0.01 0.07 0.05 0.12 0.16 0.21  0.31    77 0.99 #> R[162] 0.19    0.01 0.07 0.07 0.13 0.18 0.24  0.33    60 1.02 #> R[163] 0.23    0.01 0.09 0.09 0.16 0.23 0.29  0.42    79 0.99 #> R[164] 0.34    0.01 0.11 0.14 0.24 0.34 0.41  0.59    78 1.01 #> R[165] 0.42    0.01 0.13 0.22 0.33 0.42 0.49  0.71    80 0.99 #> R[166] 0.48    0.02 0.16 0.22 0.37 0.47 0.57  0.81    80 0.99 #> R[167] 0.52    0.02 0.17 0.26 0.39 0.48 0.63  0.84   113 0.99 #> R[168] 0.55    0.03 0.20 0.23 0.41 0.52 0.64  0.97    56 1.00 #> R[169] 0.64    0.02 0.21 0.30 0.49 0.62 0.79  1.09    92 1.01 #> R[170] 0.73    0.02 0.22 0.34 0.59 0.71 0.87  1.18    83 1.00 #> R[171] 0.84    0.03 0.26 0.34 0.67 0.78 1.05  1.32    81 0.99 #> R[172] 0.92    0.04 0.28 0.49 0.68 0.90 1.12  1.51    61 0.99 #> R[173] 1.01    0.03 0.26 0.54 0.85 1.03 1.16  1.52    72 1.00 #> R[174] 1.05    0.04 0.30 0.52 0.86 1.06 1.23  1.67    69 0.99 #> R[175] 1.13    0.04 0.33 0.59 0.88 1.13 1.36  1.85    67 0.99 #> R[176] 1.21    0.04 0.33 0.67 0.96 1.18 1.44  1.88    74 0.99 #> R[177] 1.27    0.03 0.32 0.75 1.08 1.26 1.45  2.02    90 0.99 #> R[178] 1.26    0.03 0.33 0.76 1.05 1.22 1.46  2.06    95 1.00 #> R[179] 1.33    0.04 0.34 0.70 1.13 1.31 1.50  2.05    93 1.01 #> R[180] 1.42    0.04 0.36 0.89 1.13 1.38 1.66  2.13    97 1.01 #> R[181] 1.51    0.04 0.37 0.96 1.24 1.48 1.72  2.36   108 1.03 #> R[182] 1.62    0.03 0.36 1.05 1.37 1.60 1.83  2.40   114 1.01 #> R[183] 1.78    0.03 0.40 1.14 1.49 1.70 2.01  2.67   160 1.02 #> R[184] 2.03    0.03 0.37 1.38 1.79 1.99 2.26  3.00   123 1.02 #> R[185] 2.20    0.03 0.34 1.53 2.01 2.19 2.40  2.95   111 1.05 #> R[186] 2.32    0.03 0.38 1.67 2.09 2.29 2.55  3.12   179 1.03 #> R[187] 2.54    0.03 0.37 1.94 2.29 2.49 2.76  3.24   181 0.99 #> R[188] 2.74    0.03 0.33 2.17 2.51 2.70 2.96  3.50   157 0.99 #> R[189] 2.82    0.04 0.35 2.28 2.53 2.79 3.09  3.55    89 1.00 #> R[190] 2.83    0.04 0.40 2.13 2.53 2.78 3.19  3.51    99 0.99 #> R[191] 2.84    0.04 0.37 2.17 2.53 2.80 3.14  3.49   109 0.99 #> R[192] 2.90    0.03 0.32 2.34 2.68 2.84 3.15  3.49   106 0.99 #> R[193] 2.93    0.02 0.31 2.38 2.71 2.93 3.16  3.50   167 0.99 #> R[194] 2.90    0.02 0.29 2.21 2.72 2.95 3.06  3.44   153 0.99 #> R[195] 3.05    0.04 0.29 2.47 2.87 3.04 3.25  3.71    68 1.00 #> R[196] 3.11    0.02 0.25 2.61 2.98 3.10 3.28  3.63   106 1.00 #> R[197] 3.00    0.03 0.27 2.56 2.82 2.98 3.19  3.50   112 1.00 #> R[198] 3.23    0.02 0.27 2.69 3.05 3.23 3.47  3.64   153 1.01 #> R[199] 3.57    0.03 0.29 2.97 3.35 3.57 3.79  4.09   103 0.99 #> R[200] 3.81    0.04 0.31 3.21 3.59 3.85 4.03  4.37    79 0.99 #>  #> Samples were drawn using NUTS(diag_e) at Fri Oct 25 15:43:33 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1). # extract posterior quantiles R_draws <- rstan::extract(fit, \"R\")[[1]] lower <- apply(R_draws, 2, function(x) quantile(x, 0.025)) middle <- apply(R_draws, 2, function(x) quantile(x, 0.5)) upper <- apply(R_draws, 2, function(x) quantile(x, 0.975))  # plot epidemic_df %>%   mutate(     lower = lower,     middle = middle,     upper = upper   ) %>%   select(t, R_t, lower, middle, upper) %>%   ggplot(aes(x = t, y = R_t)) +   geom_line(colour = \"red\") +   geom_ribbon(aes(ymin = lower, ymax = upper), fill = \"blue\", alpha = 0.4) +   geom_line(aes(y = middle))"},{"path":"https://ben18785.github.io/epidp/articles/fitting_synthetic_data_using_epidp.html","id":"step-function-in-r_t","dir":"Articles","previous_headings":"","what":"Step function in RtR_t","title":"Fitting synthetic data using epidp","text":"first generate case data assuming step function RtR_t.  now use Stan version EpiFilter estimate maximum posteriori estimates RtR_t overlay top actual values. Note, estimates uncertainty associated benefit estimation instantaneous. estimates close actual RtR_t values initial period case counts low.","code":"rt_fun <- function(t) {   if (t <= 60) {     R <- 2   } else if (t <= 90) {     R <- 0.5   } else {     R <- 1   }   R }  # simulation parameters nt <- 200 mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0)  # plot transform_factor <- 300 epidemic_df %>%   select(-c(w_dist, lambda_t)) %>%   mutate(R_t = R_t * transform_factor) %>%   pivot_longer(c(i_t, R_t)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / transform_factor, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\") +   theme_minimal() +   scale_color_brewer(\"Series\", palette = \"Dark2\") # fit model fit <- fit_epifilter(   N = length(epidemic_df$i_t),   C = epidemic_df$i_t,   w = epidemic_df$w_dist,   is_sampling = FALSE,   as_vector = FALSE )  # plot R <- fit$par$R epidemic_df %>%   mutate(estimated = R) %>%   rename(true = R_t) %>%   select(t, estimated, true) %>%   pivot_longer(c(estimated, true)) %>%   ggplot(aes(x = t, y = value)) +   geom_line(aes(colour = name)) +   scale_color_brewer(\"R_t\", palette = \"Dark2\") +   ylab(\"R_t\")"},{"path":"https://ben18785.github.io/epidp/articles/fitting_synthetic_data_using_epidp.html","id":"sinusoidal-function-in-r_t","dir":"Articles","previous_headings":"","what":"Sinusoidal function in RtR_t","title":"Fitting synthetic data using epidp","text":"now generate case data assuming sinusoidal RtR_t.  now use Stan version EpiFilter estimate RtR_t profile. now overlay estimated RtR_t versus actual values. estimated RtR_t values coincide reasonably true values.","code":"# define sinusoidal Rt rt_fun <- function(t) {   1.3 + 1.2 * sin(4 * (pi / 180) * t) } nt <- 200 mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0)  # plot transform_factor <- 150 epidemic_df %>%   select(-c(w_dist, lambda_t)) %>%   mutate(R_t = R_t * transform_factor) %>%   pivot_longer(c(i_t, R_t)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / transform_factor, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\") +   theme_minimal() +   scale_color_brewer(\"Series\", palette = \"Dark2\") # fit model fit <- fit_epifilter(   N = length(epidemic_df$i_t),   C = epidemic_df$i_t,   w = epidemic_df$w_dist,   iter = 200,   chains = 1 # to pass CRAN ) #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.001577 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 15.77 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 15 #> Chain 1:            adapt_window = 75 #> Chain 1:            term_buffer = 10 #> Chain 1:  #> Chain 1: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 1: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 1: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 1: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 1: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 1: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 1: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 1: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 1: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 1: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 1: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 1: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 10.628 seconds (Warm-up) #> Chain 1:                10.86 seconds (Sampling) #> Chain 1:                21.488 seconds (Total) #> Chain 1: #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # look at MCMC summaries print(fit, c(\"sigma\", \"R\")) #> Inference for Stan model: epifilter. #> 1 chains, each with iter=200; warmup=100; thin=1;  #> post-warmup draws per chain=100, total post-warmup draws=100. #>  #>        mean se_mean   sd 2.5%  25%  50%  75% 97.5% n_eff Rhat #> sigma  0.14    0.00 0.01 0.12 0.13 0.14 0.14  0.16    32 0.99 #> R[1]   1.58    0.05 0.46 0.70 1.31 1.55 1.82  2.51    76 0.99 #> R[2]   1.57    0.05 0.40 0.83 1.28 1.54 1.82  2.50    69 0.99 #> R[3]   1.58    0.05 0.38 0.83 1.35 1.56 1.77  2.45    61 0.99 #> R[4]   1.54    0.05 0.34 0.90 1.31 1.51 1.73  2.20    55 0.99 #> R[5]   1.53    0.04 0.33 0.90 1.32 1.50 1.76  2.15    56 0.99 #> R[6]   1.60    0.04 0.33 1.02 1.37 1.60 1.85  2.22    56 1.00 #> R[7]   1.67    0.04 0.33 1.05 1.41 1.65 1.89  2.34    63 0.99 #> R[8]   1.71    0.04 0.36 1.02 1.42 1.73 1.96  2.46    90 1.00 #> R[9]   1.77    0.04 0.36 1.16 1.51 1.75 2.05  2.55   106 0.99 #> R[10]  1.86    0.03 0.33 1.27 1.64 1.85 2.07  2.48   120 0.99 #> R[11]  1.91    0.03 0.34 1.34 1.62 1.92 2.09  2.62   103 0.99 #> R[12]  1.93    0.03 0.32 1.39 1.72 1.88 2.13  2.51   114 0.99 #> R[13]  1.97    0.03 0.29 1.51 1.75 1.95 2.13  2.55   131 0.99 #> R[14]  2.03    0.02 0.30 1.52 1.82 2.02 2.23  2.60   172 0.99 #> R[15]  2.07    0.02 0.31 1.42 1.91 2.04 2.29  2.63   168 1.00 #> R[16]  2.11    0.03 0.31 1.49 1.92 2.08 2.31  2.76   111 0.99 #> R[17]  2.16    0.03 0.29 1.56 1.98 2.14 2.34  2.77    89 1.00 #> R[18]  2.25    0.03 0.28 1.71 2.08 2.22 2.42  2.76   104 0.99 #> R[19]  2.33    0.02 0.27 1.87 2.16 2.29 2.52  2.85   160 1.00 #> R[20]  2.40    0.02 0.26 1.94 2.24 2.40 2.55  2.84   113 1.00 #> R[21]  2.49    0.03 0.25 2.04 2.31 2.49 2.64  3.02    92 0.99 #> R[22]  2.61    0.02 0.26 2.15 2.42 2.59 2.80  3.11   148 1.00 #> R[23]  2.63    0.03 0.27 2.21 2.40 2.62 2.86  3.09   103 1.00 #> R[24]  2.63    0.02 0.27 2.09 2.45 2.61 2.76  3.20   123 1.00 #> R[25]  2.55    0.02 0.25 2.06 2.38 2.55 2.70  3.07   109 1.03 #> R[26]  2.53    0.02 0.21 2.15 2.36 2.53 2.68  2.96    96 1.02 #> R[27]  2.61    0.02 0.20 2.22 2.45 2.61 2.74  2.94   103 0.99 #> R[28]  2.44    0.02 0.19 2.09 2.31 2.44 2.57  2.83   114 0.99 #> R[29]  2.28    0.02 0.20 1.93 2.16 2.27 2.41  2.61   107 0.99 #> R[30]  2.20    0.02 0.17 1.88 2.08 2.21 2.30  2.55    92 1.03 #> R[31]  2.19    0.02 0.17 1.91 2.08 2.19 2.29  2.52   110 0.99 #> R[32]  2.13    0.01 0.17 1.85 2.02 2.13 2.23  2.50   129 0.99 #> R[33]  2.20    0.01 0.17 1.92 2.09 2.19 2.29  2.61   136 0.99 #> R[34]  2.10    0.02 0.15 1.82 1.98 2.09 2.23  2.35    88 0.99 #> R[35]  1.92    0.01 0.15 1.64 1.83 1.92 2.03  2.21   111 0.99 #> R[36]  1.87    0.02 0.14 1.61 1.76 1.85 1.96  2.13    84 1.00 #> R[37]  1.82    0.01 0.14 1.56 1.74 1.81 1.92  2.09   103 1.02 #> R[38]  1.84    0.01 0.12 1.65 1.76 1.83 1.95  2.04    93 1.00 #> R[39]  1.75    0.01 0.12 1.56 1.67 1.75 1.84  2.00    80 0.99 #> R[40]  1.59    0.01 0.09 1.44 1.51 1.58 1.65  1.78   118 0.99 #> R[41]  1.60    0.01 0.10 1.43 1.52 1.61 1.68  1.77    98 1.02 #> R[42]  1.51    0.01 0.10 1.33 1.43 1.49 1.59  1.68   128 0.99 #> R[43]  1.35    0.01 0.10 1.17 1.27 1.33 1.40  1.56    86 0.99 #> R[44]  1.48    0.01 0.10 1.29 1.42 1.48 1.53  1.70   103 0.99 #> R[45]  1.35    0.01 0.09 1.20 1.29 1.35 1.42  1.52   129 0.99 #> R[46]  1.37    0.01 0.10 1.19 1.31 1.37 1.43  1.57   184 0.99 #> R[47]  1.31    0.01 0.08 1.14 1.26 1.30 1.35  1.46    80 0.99 #> R[48]  1.14    0.01 0.08 0.98 1.09 1.14 1.18  1.31    93 0.99 #> R[49]  1.03    0.01 0.08 0.89 0.99 1.02 1.09  1.18    84 0.99 #> R[50]  0.89    0.01 0.07 0.74 0.84 0.88 0.94  1.01   109 0.99 #> R[51]  0.81    0.01 0.06 0.70 0.76 0.80 0.84  0.94   133 0.99 #> R[52]  0.78    0.01 0.06 0.65 0.74 0.78 0.82  0.88    94 1.00 #> R[53]  0.61    0.01 0.06 0.52 0.58 0.61 0.64  0.72    48 0.99 #> R[54]  0.60    0.00 0.06 0.49 0.56 0.61 0.64  0.71   151 1.02 #> R[55]  0.56    0.01 0.05 0.46 0.53 0.57 0.60  0.66    68 1.02 #> R[56]  0.46    0.01 0.05 0.36 0.43 0.45 0.49  0.55    91 1.00 #> R[57]  0.41    0.00 0.04 0.33 0.38 0.41 0.44  0.49   113 0.99 #> R[58]  0.34    0.00 0.04 0.27 0.31 0.34 0.37  0.41   103 1.00 #> R[59]  0.24    0.00 0.04 0.16 0.21 0.24 0.26  0.31   152 0.99 #> R[60]  0.22    0.00 0.03 0.16 0.19 0.22 0.23  0.29   176 1.01 #> R[61]  0.18    0.00 0.03 0.12 0.16 0.18 0.20  0.25   122 0.99 #> R[62]  0.18    0.00 0.04 0.12 0.15 0.17 0.20  0.24   126 0.99 #> R[63]  0.17    0.00 0.04 0.11 0.14 0.17 0.19  0.25   144 0.99 #> R[64]  0.12    0.00 0.03 0.07 0.10 0.12 0.14  0.20   109 0.99 #> R[65]  0.12    0.00 0.04 0.07 0.09 0.12 0.15  0.20   167 1.01 #> R[66]  0.09    0.00 0.03 0.04 0.07 0.09 0.12  0.15    83 1.05 #> R[67]  0.10    0.00 0.04 0.03 0.07 0.08 0.12  0.18    98 1.01 #> R[68]  0.13    0.00 0.05 0.05 0.09 0.12 0.15  0.23   100 1.03 #> R[69]  0.15    0.01 0.06 0.06 0.11 0.14 0.17  0.29   119 0.99 #> R[70]  0.17    0.01 0.06 0.07 0.12 0.15 0.20  0.31    84 0.99 #> R[71]  0.19    0.01 0.07 0.10 0.14 0.19 0.24  0.32    77 0.99 #> R[72]  0.24    0.01 0.08 0.11 0.18 0.23 0.31  0.42    82 0.99 #> R[73]  0.26    0.01 0.08 0.10 0.20 0.25 0.31  0.42    70 0.99 #> R[74]  0.28    0.01 0.10 0.10 0.21 0.28 0.35  0.50    55 0.99 #> R[75]  0.32    0.01 0.12 0.12 0.24 0.30 0.39  0.56    69 0.99 #> R[76]  0.36    0.01 0.12 0.18 0.28 0.34 0.43  0.62    72 0.99 #> R[77]  0.46    0.02 0.14 0.24 0.38 0.44 0.54  0.80    64 0.99 #> R[78]  0.54    0.02 0.17 0.31 0.45 0.50 0.63  0.96    78 0.99 #> R[79]  0.61    0.02 0.16 0.35 0.49 0.59 0.70  0.97    83 0.99 #> R[80]  0.66    0.02 0.18 0.38 0.55 0.65 0.75  1.10    69 0.99 #> R[81]  0.74    0.02 0.18 0.39 0.65 0.74 0.83  1.12    85 0.99 #> R[82]  0.84    0.02 0.23 0.44 0.71 0.81 0.95  1.34    84 0.99 #> R[83]  0.96    0.03 0.23 0.53 0.79 0.92 1.12  1.43    67 0.99 #> R[84]  1.02    0.03 0.24 0.57 0.86 1.03 1.19  1.53    75 0.99 #> R[85]  1.13    0.03 0.26 0.61 0.98 1.13 1.27  1.65    80 0.99 #> R[86]  1.22    0.03 0.29 0.67 1.03 1.22 1.40  1.85    79 1.00 #> R[87]  1.33    0.03 0.26 0.77 1.15 1.30 1.51  1.88    82 0.99 #> R[88]  1.41    0.03 0.25 0.91 1.25 1.43 1.58  1.93    71 0.99 #> R[89]  1.44    0.03 0.26 0.94 1.23 1.43 1.63  1.89    91 0.99 #> R[90]  1.49    0.02 0.25 1.06 1.32 1.46 1.68  1.97   103 0.99 #> R[91]  1.50    0.03 0.25 0.98 1.32 1.49 1.67  1.93    76 1.00 #> R[92]  1.49    0.04 0.25 1.07 1.31 1.49 1.62  1.99    48 0.99 #> R[93]  1.52    0.02 0.25 1.09 1.37 1.49 1.69  2.07   105 0.99 #> R[94]  1.55    0.02 0.26 1.13 1.37 1.54 1.70  2.09   141 1.00 #> R[95]  1.62    0.02 0.25 1.18 1.45 1.62 1.75  2.17   122 1.00 #> R[96]  1.68    0.02 0.24 1.27 1.51 1.68 1.82  2.22   130 0.99 #> R[97]  1.79    0.02 0.20 1.43 1.67 1.79 1.93  2.25   121 1.00 #> R[98]  1.86    0.02 0.22 1.48 1.72 1.84 1.98  2.34   131 0.99 #> R[99]  1.92    0.02 0.26 1.48 1.74 1.90 2.11  2.41   187 0.99 #> R[100] 1.96    0.02 0.24 1.49 1.79 1.98 2.11  2.41   153 1.00 #> R[101] 2.04    0.02 0.24 1.63 1.88 2.04 2.19  2.49   200 0.99 #> R[102] 2.13    0.02 0.26 1.66 1.95 2.14 2.30  2.61   159 0.99 #> R[103] 2.19    0.02 0.28 1.69 2.00 2.18 2.37  2.77   168 0.99 #> R[104] 2.27    0.02 0.26 1.84 2.06 2.22 2.46  2.76   118 1.01 #> R[105] 2.22    0.03 0.25 1.73 2.03 2.23 2.41  2.72    84 1.00 #> R[106] 2.20    0.02 0.23 1.75 2.04 2.20 2.41  2.59   102 1.00 #> R[107] 2.25    0.03 0.24 1.82 2.09 2.23 2.40  2.67    83 1.00 #> R[108] 2.40    0.02 0.22 2.02 2.23 2.40 2.57  2.82   113 0.99 #> R[109] 2.56    0.02 0.20 2.19 2.42 2.57 2.69  2.99   103 1.02 #> R[110] 2.57    0.02 0.20 2.27 2.43 2.55 2.70  3.04    99 0.99 #> R[111] 2.62    0.02 0.20 2.16 2.48 2.63 2.73  2.99   111 0.99 #> R[112] 2.41    0.01 0.18 2.08 2.27 2.44 2.52  2.76   161 0.99 #> R[113] 2.43    0.02 0.20 2.03 2.30 2.41 2.55  2.82   114 1.00 #> R[114] 2.52    0.02 0.18 2.24 2.37 2.52 2.68  2.84   100 0.99 #> R[115] 2.54    0.02 0.18 2.18 2.42 2.53 2.69  2.89   112 0.99 #> R[116] 2.52    0.02 0.17 2.21 2.40 2.51 2.64  2.82   125 0.99 #> R[117] 2.33    0.02 0.17 2.04 2.20 2.33 2.43  2.63   112 0.99 #> R[118] 2.43    0.02 0.14 2.15 2.36 2.45 2.52  2.66    88 1.00 #> R[119] 2.47    0.02 0.15 2.21 2.37 2.45 2.56  2.83    90 1.02 #> R[120] 2.33    0.01 0.11 2.11 2.27 2.33 2.39  2.55   101 1.04 #> R[121] 2.20    0.01 0.12 1.98 2.13 2.20 2.30  2.40    72 1.00 #> R[122] 2.21    0.02 0.11 2.02 2.14 2.20 2.28  2.47    45 1.03 #> R[123] 2.12    0.01 0.11 1.93 2.03 2.12 2.19  2.32    93 0.99 #> R[124] 2.08    0.01 0.10 1.91 2.01 2.07 2.14  2.30    67 0.99 #> R[125] 2.01    0.01 0.10 1.83 1.94 2.00 2.08  2.19   112 0.99 #> R[126] 1.90    0.01 0.08 1.76 1.84 1.90 1.96  2.03    76 0.99 #> R[127] 1.94    0.01 0.08 1.82 1.87 1.93 1.98  2.11    79 0.99 #> R[128] 1.88    0.01 0.08 1.71 1.82 1.88 1.94  2.06    72 1.00 #> R[129] 1.79    0.01 0.08 1.65 1.73 1.79 1.85  1.95    86 0.99 #> R[130] 1.75    0.01 0.07 1.59 1.70 1.75 1.80  1.89    86 1.00 #> R[131] 1.69    0.01 0.06 1.57 1.65 1.69 1.74  1.81    99 0.99 #> R[132] 1.49    0.01 0.07 1.39 1.44 1.48 1.53  1.62   101 1.00 #> R[133] 1.45    0.01 0.06 1.34 1.40 1.44 1.49  1.56    82 0.99 #> R[134] 1.32    0.01 0.06 1.21 1.28 1.33 1.37  1.42   108 0.99 #> R[135] 1.36    0.01 0.05 1.26 1.34 1.36 1.39  1.45    34 1.06 #> R[136] 1.30    0.01 0.05 1.19 1.26 1.30 1.35  1.39    81 1.00 #> R[137] 1.12    0.01 0.04 1.04 1.10 1.13 1.15  1.21    66 1.00 #> R[138] 1.02    0.00 0.04 0.95 0.99 1.02 1.05  1.11    80 0.99 #> R[139] 0.93    0.00 0.04 0.86 0.91 0.93 0.96  1.02    94 1.00 #> R[140] 0.87    0.00 0.04 0.80 0.84 0.86 0.89  0.95    77 0.99 #> R[141] 0.85    0.00 0.04 0.77 0.82 0.84 0.87  0.92    70 1.00 #> R[142] 0.80    0.01 0.04 0.72 0.78 0.80 0.82  0.87    59 1.02 #> R[143] 0.67    0.00 0.04 0.61 0.65 0.67 0.70  0.73   124 1.00 #> R[144] 0.62    0.00 0.03 0.55 0.60 0.62 0.64  0.68   180 1.01 #> R[145] 0.48    0.00 0.03 0.43 0.46 0.48 0.50  0.53   153 1.01 #> R[146] 0.42    0.00 0.03 0.37 0.40 0.42 0.44  0.47    97 0.99 #> R[147] 0.40    0.00 0.03 0.36 0.38 0.40 0.41  0.47    91 0.99 #> R[148] 0.37    0.00 0.03 0.31 0.35 0.37 0.39  0.42    82 0.99 #> R[149] 0.31    0.00 0.03 0.27 0.29 0.31 0.34  0.36   114 0.99 #> R[150] 0.25    0.00 0.03 0.20 0.24 0.25 0.27  0.30    99 1.03 #> R[151] 0.20    0.00 0.02 0.16 0.19 0.20 0.22  0.25   110 0.99 #> R[152] 0.21    0.00 0.03 0.17 0.19 0.20 0.22  0.26   117 1.03 #> R[153] 0.16    0.00 0.02 0.13 0.15 0.17 0.18  0.20    90 1.04 #> R[154] 0.13    0.00 0.02 0.10 0.12 0.13 0.15  0.17   146 0.99 #> R[155] 0.12    0.00 0.02 0.09 0.11 0.12 0.13  0.16   111 0.99 #> R[156] 0.08    0.00 0.02 0.05 0.07 0.08 0.10  0.12   119 0.99 #> R[157] 0.09    0.00 0.03 0.04 0.07 0.09 0.11  0.14   176 0.99 #> R[158] 0.11    0.00 0.03 0.06 0.09 0.11 0.12  0.16   121 1.01 #> R[159] 0.11    0.00 0.03 0.06 0.09 0.10 0.12  0.17   167 0.99 #> R[160] 0.10    0.00 0.03 0.05 0.07 0.09 0.12  0.17   115 0.99 #> R[161] 0.12    0.00 0.04 0.05 0.09 0.11 0.14  0.20   110 0.99 #> R[162] 0.12    0.00 0.05 0.04 0.08 0.12 0.15  0.21   119 1.00 #> R[163] 0.16    0.00 0.04 0.08 0.12 0.15 0.18  0.25   140 1.01 #> R[164] 0.16    0.00 0.05 0.08 0.13 0.16 0.19  0.26    98 1.01 #> R[165] 0.20    0.01 0.07 0.09 0.15 0.19 0.24  0.36    82 0.99 #> R[166] 0.22    0.01 0.07 0.10 0.16 0.21 0.26  0.37   106 0.99 #> R[167] 0.27    0.01 0.09 0.13 0.22 0.27 0.32  0.47   120 0.99 #> R[168] 0.33    0.01 0.10 0.18 0.25 0.32 0.38  0.56    88 0.99 #> R[169] 0.43    0.01 0.13 0.22 0.34 0.42 0.51  0.72    85 0.99 #> R[170] 0.48    0.01 0.14 0.23 0.39 0.45 0.55  0.78    91 1.00 #> R[171] 0.55    0.02 0.15 0.31 0.44 0.54 0.63  0.86    53 1.03 #> R[172] 0.64    0.02 0.15 0.33 0.53 0.63 0.73  0.97    45 1.00 #> R[173] 0.75    0.02 0.16 0.51 0.65 0.73 0.85  1.08    70 0.99 #> R[174] 0.89    0.02 0.16 0.59 0.78 0.88 1.01  1.21    91 0.99 #> R[175] 0.97    0.02 0.19 0.63 0.84 0.95 1.07  1.41   107 0.99 #> R[176] 1.05    0.02 0.19 0.72 0.94 1.02 1.17  1.42   128 1.00 #> R[177] 1.13    0.02 0.21 0.74 1.00 1.13 1.25  1.55   125 0.99 #> R[178] 1.18    0.02 0.21 0.88 1.02 1.17 1.31  1.66   111 1.00 #> R[179] 1.29    0.02 0.23 0.90 1.16 1.25 1.38  1.81   113 0.99 #> R[180] 1.28    0.02 0.20 0.89 1.14 1.28 1.44  1.59   132 0.99 #> R[181] 1.33    0.02 0.22 0.95 1.17 1.33 1.47  1.69   114 1.00 #> R[182] 1.45    0.02 0.25 1.03 1.28 1.44 1.60  1.88   153 1.00 #> R[183] 1.54    0.02 0.23 1.10 1.39 1.59 1.69  1.97   167 1.00 #> R[184] 1.67    0.02 0.23 1.27 1.49 1.66 1.86  2.16   142 1.00 #> R[185] 1.81    0.02 0.24 1.41 1.64 1.80 2.00  2.28   173 0.99 #> R[186] 1.84    0.02 0.22 1.44 1.66 1.84 1.97  2.28   153 0.99 #> R[187] 1.88    0.02 0.24 1.42 1.73 1.87 2.04  2.36   166 0.99 #> R[188] 1.98    0.02 0.23 1.55 1.83 1.98 2.11  2.40   200 1.00 #> R[189] 2.07    0.02 0.24 1.68 1.92 2.01 2.19  2.59   200 1.00 #> R[190] 2.01    0.01 0.20 1.66 1.88 1.99 2.12  2.48   195 0.99 #> R[191] 2.01    0.02 0.24 1.65 1.84 1.97 2.16  2.50   200 0.99 #> R[192] 2.00    0.02 0.23 1.68 1.84 1.97 2.15  2.53   200 0.99 #> R[193] 2.10    0.02 0.21 1.73 1.98 2.08 2.24  2.47   200 1.00 #> R[194] 2.22    0.03 0.21 1.83 2.09 2.22 2.34  2.62    68 1.02 #> R[195] 2.27    0.02 0.19 1.94 2.15 2.25 2.38  2.74   142 0.99 #> R[196] 2.36    0.02 0.19 2.03 2.23 2.34 2.47  2.75    90 1.01 #> R[197] 2.42    0.02 0.18 2.04 2.31 2.41 2.57  2.73    94 1.04 #> R[198] 2.30    0.02 0.18 1.94 2.17 2.30 2.42  2.68    98 1.01 #> R[199] 2.32    0.01 0.17 2.04 2.22 2.32 2.42  2.69   150 0.99 #> R[200] 2.21    0.02 0.20 1.84 2.06 2.21 2.35  2.59    97 1.00 #>  #> Samples were drawn using NUTS(diag_e) at Fri Oct 25 15:44:03 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1). # extract posterior quantiles R_draws <- rstan::extract(fit, \"R\")[[1]] lower <- apply(R_draws, 2, function(x) quantile(x, 0.025)) middle <- apply(R_draws, 2, function(x) quantile(x, 0.5)) upper <- apply(R_draws, 2, function(x) quantile(x, 0.975))  # plot epidemic_df %>%   mutate(     lower = lower,     middle = middle,     upper = upper   ) %>%   select(t, R_t, lower, middle, upper) %>%   ggplot(aes(x = t, y = R_t)) +   geom_line(colour = \"red\") +   geom_ribbon(aes(ymin = lower, ymax = upper), fill = \"blue\", alpha = 0.4) +   geom_line(aes(y = middle))"},{"path":"https://ben18785.github.io/epidp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ben Lambert. Author, maintainer. Kris Parag. Author.","code":""},{"path":"https://ben18785.github.io/epidp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lambert B, Parag K (2024). epidp: Estimating Epidemiological Parameters Interest Using Covariate Information. R package version 0.0.0.9000, https://ben18785.github.io/epidp/.","code":"@Manual{,   title = {epidp: Estimating Epidemiological Parameters Of Interest Using Covariate Information},   author = {Ben Lambert and Kris Parag},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://ben18785.github.io/epidp/}, }"},{"path":"https://ben18785.github.io/epidp/index.html","id":"epidp","dir":"","previous_headings":"","what":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"goal epidp allow covariate information inform estimates time-varying reproduction number, RtR_t.","code":""},{"path":"https://ben18785.github.io/epidp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"can install development version epidp GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"ben18785/epidp\")"},{"path":[]},{"path":"https://ben18785.github.io/epidp/index.html","id":"step-function-in-r_t","dir":"","previous_headings":"Example","what":"Step function in RtR_t","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"first generate case data assuming step function RtR_t.  now use Stan version EpiFilter estimate maximum posteriori estimates RtR_t overlay top actual values. Note, estimates uncertainty associated benefit estimation instantaneous. estimates close actual RtR_t values initial period case counts low.","code":"library(epidp) library(ggplot2) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(magrittr) library(purrr) #>  #> Attaching package: 'purrr' #> The following object is masked from 'package:magrittr': #>  #>     set_names library(tidyr) #>  #> Attaching package: 'tidyr' #> The following object is masked from 'package:magrittr': #>  #>     extract  rt_fun <- function(t) {   if (t <= 60) {     R <- 2   } else if (t <= 90) {     R <- 0.5   } else {     R <- 1   }   R }  # simulation parameters nt <- 200 mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0)  # plot transform_factor <- 300 epidemic_df %>%   select(-c(w_dist, lambda_t)) %>%   mutate(R_t = R_t * transform_factor) %>%   pivot_longer(c(i_t, R_t)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / transform_factor, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\") +   theme_minimal() +   scale_color_brewer(\"Series\", palette = \"Dark2\") # fit model fit <- fit_epifilter(   N = length(epidemic_df$i_t),   C = epidemic_df$i_t,   w = epidemic_df$w_dist,   is_sampling = FALSE,   as_vector = FALSE )  # plot R <- fit$par$R epidemic_df %>%   mutate(estimated = R) %>%   rename(true = R_t) %>%   select(t, estimated, true) %>%   pivot_longer(c(estimated, true)) %>%   ggplot(aes(x = t, y = value)) +   geom_line(aes(colour = name)) +   scale_color_brewer(\"R_t\", palette = \"Dark2\") +   ylab(\"R_t\") +   xlab(\"Time\") +   theme_minimal()"},{"path":"https://ben18785.github.io/epidp/index.html","id":"contributing-guidelines","dir":"","previous_headings":"","what":"Contributing guidelines","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"welcome contributions collaborators. , ask read contributing guidelines section.","code":""},{"path":"https://ben18785.github.io/epidp/reference/covid_colombia_cases_deaths_mobility.html","id":null,"dir":"Reference","previous_headings":"","what":"Daily COVID-19 case data for Bogota and Medellin and corresponding Google mobility data — covid_colombia_cases_deaths_mobility","title":"Daily COVID-19 case data for Bogota and Medellin and corresponding Google mobility data — covid_colombia_cases_deaths_mobility","text":"Daily COVID-19 case data Bogota Medellin corresponding Google mobility data","code":""},{"path":"https://ben18785.github.io/epidp/reference/covid_colombia_cases_deaths_mobility.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Daily COVID-19 case data for Bogota and Medellin and corresponding Google mobility data — covid_colombia_cases_deaths_mobility","text":"","code":"covid_colombia_cases_deaths_mobility"},{"path":[]},{"path":"https://ben18785.github.io/epidp/reference/covid_colombia_cases_deaths_mobility.html","id":"covid-colombia-cases-deaths-mobility","dir":"Reference","previous_headings":"","what":"covid_colombia_cases_deaths_mobility","title":"Daily COVID-19 case data for Bogota and Medellin and corresponding Google mobility data — covid_colombia_cases_deaths_mobility","text":"data frame 1348 rows 10 columns: date Daily city Bogota Medellin cases Daily counts COVID-19 cases deaths Daily counts COVID-19 deaths","code":""},{"path":"https://ben18785.github.io/epidp/reference/covid_colombia_cases_deaths_mobility.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Daily COVID-19 case data for Bogota and Medellin and corresponding Google mobility data — covid_colombia_cases_deaths_mobility","text":"https://github.com/TRACE-LAC/pet-epi-notebooks/tree/main https://www.google.com/covid19/mobility/","code":""},{"path":"https://ben18785.github.io/epidp/reference/epidp-package.html","id":null,"dir":"Reference","previous_headings":"","what":"epidp: Estimating Epidemiological Parameters Of Interest Using Covariate Information — epidp-package","title":"epidp: Estimating Epidemiological Parameters Of Interest Using Covariate Information — epidp-package","text":"package uses Stan estimate epidemiological quantities interest.","code":""},{"path":[]},{"path":"https://ben18785.github.io/epidp/reference/epidp-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"epidp: Estimating Epidemiological Parameters Of Interest Using Covariate Information — epidp-package","text":"Maintainer: Ben Lambert ben.c.lambert@gmail.com Authors: Kris Parag k.parag@imperial.ac.uk","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"Estimate time-varying reproduction number incidence data","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"","code":"fit_epifilter(N, C, w, is_sampling = TRUE, ...)"},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"N number data points C case counts w discretised serial interval is_sampling Boolean indicating sampling used (TRUE) optimisation (FALSE). Defaults TRUE ... Arguments passed rstan::sampling() (is_sampling=TRUE) rstan::optimizing() (is_sampling=FALSE)","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"stanfit object","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"Estimate time-varying reproduction number incidence data using covariate data","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"","code":"fit_epifilter_covariates(N, C, w, X, is_sampling = TRUE, ...)"},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"N number data points C case counts w discretised serial interval X matrix covariates (likely include first column 1s) dimensions N x (N_covariates + 1) is_sampling Boolean indicating sampling used (TRUE) optimisation (FALSE). Defaults TRUE ... Arguments passed rstan::sampling() (is_sampling=TRUE) rstan::optimizing() (is_sampling=FALSE)","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"stanfit object","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"function generates discretized serial interval distribution based gamma distribution characterized specified mean standard deviation.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"","code":"generate_vector_serial(nt, mean_si, sd_si)"},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"nt integer specifying number time points (length distribution). mean_si numeric value representing mean serial interval distribution. sd_si numeric value representing standard deviation serial interval distribution.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"numeric vector length nt representing discretized serial interval distribution.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"serial interval distribution discretized using gamma distribution shape scale parameters derived specified mean standard deviation. discretization performed computing difference cumulative distribution function (CDF) gamma distribution successive integer time points.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"","code":"generate_vector_serial(10, 5, 2) #>  [1] 0.001202812 0.031215396 0.117173708 0.194349722 0.209280731 0.173135177 #>  [7] 0.120019422 0.073307035 0.040717681 0.021005459"},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"function simulates epidemic using renewal model based specified time-varying reproduction number (Rt), serial interval distribution characterized gamma distribution, initial number cases.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"","code":"simulate_renewal_epidemic(Rt_fun, nt, mean_si, sd_si, i_0, X = NULL)"},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"Rt_fun function takes vector time points returns vector reproduction numbers (Rt) corresponding time points. nt integer specifying number time points (duration epidemic simulation). mean_si numeric value representing mean serial interval distribution. sd_si numeric value representing standard deviation serial interval distribution. i_0 integer specifying initial number cases time point 1. X optional matrix covariates nt rows.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"list containing following components: i_t numeric vector incidence new cases time point. lambda_t numeric vector total infectiousness time point. w_dist numeric vector discretized serial interval distribution. r_t numeric vector reproduction number (Rt) time point. t numeric vector time points 1 nt.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"renewal model common approach simulating spread infectious diseases. total infectiousness time point computed convolution past incidence serial interval distribution. incidence time point simulated Poisson random variable mean equal product total infectiousness time-varying reproduction number.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"","code":"rt_fun <- function(t) {   1.5 * exp(-0.05 * t) } simulate_renewal_epidemic(rt_fun, 100, 5, 2, 10) #>       t i_t        R_t     lambda_t       w_dist #> 1     1  10 1.42684414 1.000000e+01 1.202812e-03 #> 2     2   0 1.35725613 1.202812e-02 3.121540e-02 #> 3     3   1 1.29106196 3.121540e-01 1.171737e-01 #> 4     4   2 1.22809613 1.172940e+00 1.943497e-01 #> 5     5   1 1.16820117 1.977118e+00 2.092807e-01 #> 6     6   0 1.11122733 2.273615e+00 1.731352e-01 #> 7     7   2 1.05703213 2.191264e+00 1.200194e-01 #> 8     8   2 1.00548007 1.917754e+00 7.330704e-02 #> 9     9   1 0.95644223 1.583953e+00 4.071768e-02 #> 10   10   2 0.90979599 1.380728e+00 2.100546e-02 #> 11   11   2 0.86542472 1.353204e+00 1.021454e-02 #> 12   12   2 0.82321745 1.398768e+00 4.732806e-03 #> 13   13   0 0.78306867 1.481441e+00 2.106387e-03 #> 14   14   0 0.74487796 1.595075e+00 9.060961e-04 #> 15   15   1 0.70854983 1.656625e+00 3.785690e-04 #> 16   16   1 0.67399345 1.528375e+00 1.542214e-04 #> 17   17   0 0.64112240 1.245436e+00 6.145378e-05 #> 18   18   0 0.60985449 9.893817e-01 2.401538e-05 #> 19   19   0 0.58011154 8.325695e-01 9.223817e-06 #> 20   20   0 0.55181916 6.984244e-01 3.488238e-06 #> 21   21   2 0.52490662 5.373851e-01 1.300919e-06 #> 22   22   0 0.49930663 3.722733e-01 4.790949e-07 #> 23   23   0 0.47495515 2.918871e-01 1.744290e-07 #> 24   24   0 0.45179132 3.646919e-01 6.284573e-08 #> 25   25   0 0.42975720 4.575370e-01 2.242704e-08 #> 26   26   1 0.40879769 4.527898e-01 7.933068e-09 #> 27   27   0 0.38886039 3.636594e-01 2.783419e-09 #> 28   28   0 0.36989545 2.785920e-01 9.692738e-10 #> 29   29   0 0.35185543 2.669968e-01 3.351808e-10 #> 30   30   0 0.33469524 2.771459e-01 1.151559e-10 #> 31   31   0 0.31837196 2.518534e-01 3.932399e-11 #> 32   32   0 0.30284478 1.937908e-01 1.335243e-11 #> 33   33   0 0.28807486 1.295745e-01 4.509726e-12 #> 34   34   0 0.27402529 7.755453e-02 1.515565e-12 #> 35   35   0 0.26066092 4.254312e-02 5.069278e-13 #> 36   36   0 0.24794833 2.176758e-02 1.688649e-13 #> 37   37   0 0.23585575 1.052483e-02 5.595524e-14 #> 38   38   0 0.22435293 4.856392e-03 1.854072e-14 #> 39   39   0 0.21341111 2.154664e-03 5.995204e-15 #> 40   40   0 0.20300292 9.246319e-04 1.998401e-15 #> 41   41   0 0.19310236 3.855768e-04 6.661338e-16 #> 42   42   0 0.18368464 1.568343e-04 2.220446e-16 #> 43   43   0 0.17472624 6.241584e-05 1.110223e-16 #> 44   44   0 0.16620474 2.436559e-05 0.000000e+00 #> 45   45   0 0.15809884 9.349972e-06 0.000000e+00 #> 46   46   0 0.15038827 3.533251e-06 0.000000e+00 #> 47   47   0 0.14305374 1.316840e-06 0.000000e+00 #> 48   48   0 0.13607693 4.846801e-07 0.000000e+00 #> 49   49   0 0.12944038 1.763738e-07 0.000000e+00 #> 50   50   0 0.12312750 6.351817e-08 0.000000e+00 #> 51   51   0 0.11712250 2.265805e-08 0.000000e+00 #> 52   52   0 0.11141037 8.011946e-09 0.000000e+00 #> 53   53   0 0.10597682 2.810200e-09 0.000000e+00 #> 54   54   0 0.10080827 9.783184e-10 0.000000e+00 #> 55   55   0 0.09589179 3.382201e-10 0.000000e+00 #> 56   56   0 0.09121509 1.161724e-10 0.000000e+00 #> 57   57   0 0.08676648 3.966261e-11 0.000000e+00 #> 58   58   0 0.08253483 1.346467e-11 0.000000e+00 #> 59   59   0 0.07850956 4.546918e-12 0.000000e+00 #> 60   60   0 0.07468060 1.527556e-12 0.000000e+00 #> 61   61   0 0.07103839 5.109246e-13 0.000000e+00 #> 62   62   0 0.06757380 1.701972e-13 0.000000e+00 #> 63   63   0 0.06427819 5.639933e-14 0.000000e+00 #> 64   64   0 0.06114331 1.876277e-14 0.000000e+00 #> 65   65   0 0.05816131 5.995204e-15 0.000000e+00 #> 66   66   0 0.05532475 1.998401e-15 0.000000e+00 #> 67   67   0 0.05262653 6.661338e-16 0.000000e+00 #> 68   68   0 0.05005990 2.220446e-16 0.000000e+00 #> 69   69   0 0.04761845 1.110223e-16 0.000000e+00 #> 70   70   0 0.04529608 0.000000e+00 0.000000e+00 #> 71   71   0 0.04308696 0.000000e+00 0.000000e+00 #> 72   72   0 0.04098558 0.000000e+00 0.000000e+00 #> 73   73   0 0.03898669 0.000000e+00 0.000000e+00 #> 74   74   0 0.03708529 0.000000e+00 0.000000e+00 #> 75   75   0 0.03527662 0.000000e+00 0.000000e+00 #> 76   76   0 0.03355616 0.000000e+00 0.000000e+00 #> 77   77   0 0.03191960 0.000000e+00 0.000000e+00 #> 78   78   0 0.03036287 0.000000e+00 0.000000e+00 #> 79   79   0 0.02888205 0.000000e+00 0.000000e+00 #> 80   80   0 0.02747346 0.000000e+00 0.000000e+00 #> 81   81   0 0.02613356 0.000000e+00 0.000000e+00 #> 82   82   0 0.02485901 0.000000e+00 0.000000e+00 #> 83   83   0 0.02364662 0.000000e+00 0.000000e+00 #> 84   84   0 0.02249337 0.000000e+00 0.000000e+00 #> 85   85   0 0.02139635 0.000000e+00 0.000000e+00 #> 86   86   0 0.02035284 0.000000e+00 0.000000e+00 #> 87   87   0 0.01936022 0.000000e+00 0.000000e+00 #> 88   88   0 0.01841601 0.000000e+00 0.000000e+00 #> 89   89   0 0.01751785 0.000000e+00 0.000000e+00 #> 90   90   0 0.01666349 0.000000e+00 0.000000e+00 #> 91   91   0 0.01585081 0.000000e+00 0.000000e+00 #> 92   92   0 0.01507775 0.000000e+00 0.000000e+00 #> 93   93   0 0.01434240 0.000000e+00 0.000000e+00 #> 94   94   0 0.01364292 0.000000e+00 0.000000e+00 #> 95   95   0 0.01297754 0.000000e+00 0.000000e+00 #> 96   96   0 0.01234462 0.000000e+00 0.000000e+00 #> 97   97   0 0.01174257 0.000000e+00 0.000000e+00 #> 98   98   0 0.01116987 0.000000e+00 0.000000e+00 #> 99   99   0 0.01062511 0.000000e+00 0.000000e+00 #> 100 100   0 0.01010692 0.000000e+00 0.000000e+00"}]
