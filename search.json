[{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to EpiDP","title":"Contributing to EpiDP","text":"love input! want make contributing project easy transparent possible, whether ’s: Reporting bug Discussing current state code Submitting fix Proposing new features Becoming maintainer","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"we-develop-with-github","dir":"","previous_headings":"","what":"We Develop with Github","title":"Contributing to EpiDP","text":"use github host code, track issues feature requests, well accept pull requests.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"we-use-github-flow-so-all-code-changes-happen-through-pull-requests","dir":"","previous_headings":"","what":"We Use Github Flow, So All Code Changes Happen Through Pull Requests","title":"Contributing to EpiDP","text":"Pull requests best way propose changes codebase (use Github Flow). actively welcome pull requests: Fork repo create branch main. ’ve added code tested, add tests. ’ve changed APIs, update documentation. Ensure test suite passes. Make sure code lints. Issue pull request!","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"any-contributions-you-make-will-be-under-the-mit-software-license","dir":"","previous_headings":"","what":"Any contributions you make will be under the MIT Software License","title":"Contributing to EpiDP","text":"short, submit code changes, submissions understood MIT License covers project. Feel free contact maintainers ’s concern.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"report-bugs-using-githubs-issues","dir":"","previous_headings":"","what":"Report bugs using Github’s issues","title":"Contributing to EpiDP","text":"use GitHub issues track public bugs. Report bug opening new issue; ’s easy!","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"write-bug-reports-with-detail-background-and-sample-code","dir":"","previous_headings":"","what":"Write bug reports with detail, background, and sample code","title":"Contributing to EpiDP","text":"example bug report wrote, think ’s bad model. ’s another example Craig Hockenberry, app developer greatly respect. Great Bug Reports tend : quick summary /background specific! Give sample code can. stackoverflow question includes sample code anyone base R setup can run reproduce seeing expected happen actually happens Notes (possibly including think might happening, stuff tried didn’t work) People love thorough bug reports. ’m even kidding.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"use-a-consistent-coding-style","dir":"","previous_headings":"","what":"Use a Consistent Coding Style","title":"Contributing to EpiDP","text":"’m borrowing Facebook’s Guidelines 2 spaces indentation rather tabs can try running npm run lint style unification","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Contributing to EpiDP","text":"contributing, agree contributions licensed MIT License.","code":""},{"path":"https://ben18785.github.io/epidp/CONTRIBUTING.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Contributing to EpiDP","text":"document adapted open-source contribution guidelines Facebook’s Draft","code":""},{"path":"https://ben18785.github.io/epidp/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 epidp authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ben18785.github.io/epidp/articles/fitting_real_covid19_data.html","id":"estimating-r_t-for-bogota-using-only-the-case-data","dir":"Articles","previous_headings":"","what":"Estimating RtR_t for Bogota using only the case data","title":"Fitting real COVID-19 case data","text":"first load COVID-19 data Colombia graph . first estimate RtR_t Bogota using case data using optimisation give us quick set estimates. now fit using fully Bayesian framework outputs uncertainty.","code":"# load data data(\"covid_colombia_cases_deaths_mobility\")  # plot covid_colombia_cases_deaths_mobility %>%    pivot_longer(c(cases, deaths)) %>%   ggplot(aes(x=date, y=value)) +   geom_line() +   facet_grid(vars(name), vars(city),              scales=\"free\") +   xlab(\"Date\") +   ylab(\"Count\") df_bogota <- covid_colombia_cases_deaths_mobility %>%    filter(city==\"Bogota\")  # generate serial interval for COVID-19 based on reasonable mean, sd mean_si <- 6.5 sd_si <- 4.03 w <- generate_vector_serial(nrow(df_bogota), mean_si, sd_si)  # fit using optimisation fit <- fit_epifilter(   N=nrow(df_bogota),   C=df_bogota$cases,   w=w,   is_sampling=FALSE,   as_vector=FALSE )  # plot R <- fit$par$R df_bogota %>%    mutate(Rt=R) %>%    select(date, Rt, cases) %>%    filter(date >= as.Date(\"2020-04-01\")) %>%    pivot_longer(-date) %>%    ggplot(aes(x=date, y=value)) +   geom_line() +   scale_color_brewer(\"R_t\", palette = \"Dark2\") +   ylab(\"R_t\") +   facet_grid(vars(name), scales = \"free\") fit <- fit_epifilter(   N=nrow(df_bogota),   C=df_bogota$cases,   w=w,   is_sampling=TRUE,   iter=50,   chains=1 # as CRAN does not allow multiple cores ) #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.015398 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 153.98 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 3 #> Chain 1:            adapt_window = 20 #> Chain 1:            term_buffer = 2 #> Chain 1:  #> Chain 1: Iteration:  1 / 50 [  2%]  (Warmup) #> Chain 1: Iteration:  5 / 50 [ 10%]  (Warmup) #> Chain 1: Iteration: 10 / 50 [ 20%]  (Warmup) #> Chain 1: Iteration: 15 / 50 [ 30%]  (Warmup) #> Chain 1: Iteration: 20 / 50 [ 40%]  (Warmup) #> Chain 1: Iteration: 25 / 50 [ 50%]  (Warmup) #> Chain 1: Iteration: 26 / 50 [ 52%]  (Sampling) #> Chain 1: Iteration: 30 / 50 [ 60%]  (Sampling) #> Chain 1: Iteration: 35 / 50 [ 70%]  (Sampling) #> Chain 1: Iteration: 40 / 50 [ 80%]  (Sampling) #> Chain 1: Iteration: 45 / 50 [ 90%]  (Sampling) #> Chain 1: Iteration: 50 / 50 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 16.398 seconds (Warm-up) #> Chain 1:                22.333 seconds (Sampling) #> Chain 1:                38.731 seconds (Total) #> Chain 1: #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # extract posterior quantiles R_draws <- rstan::extract(fit, \"R\")[[1]] lower <- apply(R_draws, 2, function(x) quantile(x, 0.025)) middle <- apply(R_draws, 2, function(x) quantile(x, 0.5)) upper <- apply(R_draws, 2, function(x) quantile(x, 0.975))  # plot df_bogota %>%    mutate(     lower=lower,     middle=middle,     upper=upper   ) %>%    select(date, lower, middle, upper) %>%    filter(date >= as.Date(\"2020-04-01\")) %>%    ggplot(aes(x=date)) +   geom_ribbon(aes(ymin=lower, ymax=upper), fill=\"blue\", alpha=0.6) +   geom_line(aes(y=middle), colour=\"blue\") +   geom_hline(yintercept = 1, linetype=2, colour=\"orange\") +   xlab(\"Date\") +   ylab(\"R_t\")"},{"path":"https://ben18785.github.io/epidp/articles/fitting_real_covid19_data.html","id":"probing-the-drivers-of-r_t-using-mobility-data","dir":"Articles","previous_headings":"","what":"Probing the drivers of RtR_t using mobility data","title":"Fitting real COVID-19 case data","text":"assume relationship workplace mobility mtm_t RtR_t form: log(Rt)=α+βmt+ϵt, \\log(R_t) = \\alpha + \\beta m_t + \\epsilon_t, ϵt\\epsilon_t represents components RtR_t unrelated workplace mobility. now fit model using epidp. negative association probably result individuals responding COVID-19 pandemic conditions governmental policy.","code":"X <- tibble(   cons=rep(1, nrow(df_bogota)),   m=df_bogota$workplaces   ) %>%    mutate(     m=scale(m)[, 1]   ) %>%    as.matrix()  fit <- fit_epifilter_covariates(   N=nrow(df_bogota),   C=df_bogota$cases,   w=w,   X=X,   is_sampling=TRUE,   iter=50, # probably too few iterations   chains=1 # as CRAN does not allow multiple cores; should run with more cores ) #>  #> SAMPLING FOR MODEL 'epifilter_covariates' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.015763 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 157.63 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 3 #> Chain 1:            adapt_window = 20 #> Chain 1:            term_buffer = 2 #> Chain 1:  #> Chain 1: Iteration:  1 / 50 [  2%]  (Warmup) #> Chain 1: Iteration:  5 / 50 [ 10%]  (Warmup) #> Chain 1: Iteration: 10 / 50 [ 20%]  (Warmup) #> Chain 1: Iteration: 15 / 50 [ 30%]  (Warmup) #> Chain 1: Iteration: 20 / 50 [ 40%]  (Warmup) #> Chain 1: Iteration: 25 / 50 [ 50%]  (Warmup) #> Chain 1: Iteration: 26 / 50 [ 52%]  (Sampling) #> Chain 1: Iteration: 30 / 50 [ 60%]  (Sampling) #> Chain 1: Iteration: 35 / 50 [ 70%]  (Sampling) #> Chain 1: Iteration: 40 / 50 [ 80%]  (Sampling) #> Chain 1: Iteration: 45 / 50 [ 90%]  (Sampling) #> Chain 1: Iteration: 50 / 50 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 3.006 seconds (Warm-up) #> Chain 1:                49.28 seconds (Sampling) #> Chain 1:                52.286 seconds (Total) #> Chain 1: #> Warning: There were 1 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See #> https://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded #> Warning: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See #> https://mc-stan.org/misc/warnings.html#bfmi-low #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  print(fit, \"beta[2]\") #> Inference for Stan model: epifilter_covariates. #> 1 chains, each with iter=50; warmup=25; thin=1;  #> post-warmup draws per chain=25, total post-warmup draws=25. #>  #>          mean se_mean   sd  2.5%   25%   50%   75% 97.5% n_eff Rhat #> beta[2] -0.07    0.01 0.01 -0.09 -0.07 -0.07 -0.06 -0.04     6  1.4 #>  #> Samples were drawn using NUTS(diag_e) at Thu Oct  3 17:00:44 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://ben18785.github.io/epidp/articles/fitting_synthetic_data_including_covariates.html","id":"added-gaussian-noise-around-a-sinusoidal-covariate-driven-mean-r_t","dir":"Articles","previous_headings":"","what":"Added Gaussian noise around a sinusoidal covariate-driven mean RtR_t","title":"Fitting synthetic data including covariates","text":"first try estimate RtR_t without covariate information. now use Stan version EpiFilter estimate RtR_t profile. now overlay estimated RtR_t versus actual values. estimated RtR_t values coincide reasonably true values.","code":"# define sinusoidal Rt with noise rt_fun <- function(t, x) {   x[1] * exp(x[2]) } nt <- 200 t <- 1:nt f <- 1.3 + 1.2 * sin(4 * (pi / 180) * t) g <- vector(length = nt) g[1] <- rnorm(1, 0, 1) rho <- 0.8 for(i in 2:length(g)) {   g[i] <- rho * g[i - 1] + rnorm(1, 0, 0.1) } X <- matrix(c(f, g), nrow = length(f), ncol = 2)  # simulation parameters mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0, X)  # plot epidemic_df %>%   mutate(f=f) %>%    select(-c(w_dist, lambda_t)) %>%   pivot_longer(c(R_t, f)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / 1000, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\", colour = \"Variable\") +   theme_minimal() # fit model fit <- fit_epifilter(   N=length(epidemic_df$i_t),   C=epidemic_df$i_t,   w=epidemic_df$w_dist,   iter=200,   chains=1 # to pass CRAN ) #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.004412 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 44.12 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 15 #> Chain 1:            adapt_window = 75 #> Chain 1:            term_buffer = 10 #> Chain 1:  #> Chain 1: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 1: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 1: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 1: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 1: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 1: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 1: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 1: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 1: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 1: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 1: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 1: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 15.196 seconds (Warm-up) #> Chain 1:                13.808 seconds (Sampling) #> Chain 1:                29.004 seconds (Total) #> Chain 1: #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # look at MCMC summaries print(fit, c(\"sigma\", \"R\")) #> Inference for Stan model: epifilter. #> 1 chains, each with iter=200; warmup=100; thin=1;  #> post-warmup draws per chain=100, total post-warmup draws=100. #>  #>        mean se_mean   sd 2.5%  25%  50%  75% 97.5% n_eff Rhat #> sigma  0.18    0.00 0.02 0.15 0.17 0.18 0.19  0.22    18 1.02 #> R[1]   1.09    0.06 0.43 0.44 0.77 1.05 1.35  1.99    56 1.00 #> R[2]   1.11    0.04 0.40 0.48 0.81 1.08 1.34  1.94    88 1.00 #> R[3]   1.11    0.04 0.36 0.51 0.85 1.06 1.36  1.90    83 0.99 #> R[4]   1.07    0.04 0.34 0.54 0.81 1.06 1.27  1.96    85 1.00 #> R[5]   1.04    0.03 0.29 0.62 0.81 1.04 1.22  1.75    77 1.03 #> R[6]   1.06    0.03 0.29 0.62 0.83 1.02 1.26  1.71    69 1.03 #> R[7]   1.06    0.03 0.28 0.62 0.87 1.03 1.25  1.62    83 1.04 #> R[8]   1.07    0.03 0.28 0.56 0.89 1.05 1.27  1.62    91 1.05 #> R[9]   1.10    0.03 0.27 0.62 0.89 1.11 1.28  1.64    74 1.03 #> R[10]  1.16    0.03 0.28 0.72 0.94 1.11 1.37  1.67    62 1.02 #> R[11]  1.26    0.03 0.29 0.77 1.06 1.20 1.45  1.91    93 0.99 #> R[12]  1.36    0.03 0.30 0.75 1.14 1.38 1.59  1.87    83 0.99 #> R[13]  1.49    0.03 0.33 1.00 1.23 1.50 1.69  2.16   101 1.01 #> R[14]  1.50    0.04 0.34 0.98 1.25 1.47 1.71  2.23    69 1.01 #> R[15]  1.53    0.04 0.35 0.93 1.28 1.50 1.79  2.22    66 1.00 #> R[16]  1.58    0.03 0.37 0.94 1.34 1.58 1.78  2.44   121 0.99 #> R[17]  1.62    0.03 0.34 1.01 1.40 1.65 1.80  2.37   104 1.00 #> R[18]  1.74    0.03 0.37 1.06 1.51 1.66 1.99  2.47   182 0.99 #> R[19]  1.82    0.03 0.38 1.19 1.56 1.76 2.04  2.66   160 0.99 #> R[20]  2.03    0.03 0.37 1.32 1.79 2.04 2.28  2.74   189 1.00 #> R[21]  2.07    0.04 0.38 1.35 1.81 2.09 2.33  2.79   120 1.00 #> R[22]  2.01    0.03 0.38 1.28 1.78 1.99 2.25  2.73   128 1.00 #> R[23]  1.98    0.03 0.31 1.43 1.77 1.96 2.15  2.70   153 0.99 #> R[24]  2.04    0.03 0.32 1.53 1.83 1.96 2.19  2.78   150 1.00 #> R[25]  2.18    0.03 0.36 1.68 1.91 2.13 2.40  3.01   163 0.99 #> R[26]  2.18    0.03 0.36 1.60 1.88 2.19 2.42  2.84   139 1.00 #> R[27]  2.06    0.03 0.33 1.47 1.80 2.04 2.32  2.68   138 1.00 #> R[28]  2.05    0.03 0.31 1.40 1.86 2.03 2.26  2.59   150 0.99 #> R[29]  1.98    0.02 0.30 1.48 1.76 1.96 2.17  2.59   200 0.99 #> R[30]  1.98    0.03 0.29 1.39 1.79 1.96 2.18  2.54   124 0.99 #> R[31]  1.96    0.03 0.25 1.55 1.78 1.96 2.07  2.52    81 1.02 #> R[32]  2.02    0.02 0.24 1.56 1.83 2.04 2.16  2.54   121 1.00 #> R[33]  2.00    0.03 0.24 1.63 1.84 1.95 2.16  2.54    90 1.01 #> R[34]  1.97    0.02 0.23 1.62 1.81 1.95 2.11  2.45    91 0.99 #> R[35]  1.97    0.02 0.24 1.60 1.81 1.93 2.12  2.47   103 0.99 #> R[36]  1.78    0.02 0.23 1.45 1.61 1.79 1.91  2.37   137 0.99 #> R[37]  1.72    0.02 0.20 1.42 1.55 1.69 1.84  2.10    94 0.99 #> R[38]  1.57    0.01 0.17 1.28 1.44 1.57 1.69  1.90   184 0.99 #> R[39]  1.58    0.02 0.17 1.30 1.48 1.57 1.69  1.94   116 0.99 #> R[40]  1.46    0.01 0.16 1.12 1.36 1.46 1.56  1.74   112 0.99 #> R[41]  1.45    0.01 0.16 1.13 1.37 1.47 1.56  1.74   133 0.99 #> R[42]  1.39    0.01 0.15 1.12 1.28 1.38 1.50  1.67   117 0.99 #> R[43]  1.21    0.01 0.15 0.95 1.11 1.21 1.31  1.49   117 0.99 #> R[44]  1.22    0.01 0.15 0.95 1.11 1.20 1.30  1.52   181 0.99 #> R[45]  1.19    0.01 0.11 1.01 1.11 1.18 1.25  1.43   117 0.99 #> R[46]  1.25    0.01 0.14 1.00 1.13 1.24 1.34  1.54   149 1.00 #> R[47]  1.23    0.01 0.14 0.98 1.14 1.23 1.32  1.50   101 1.00 #> R[48]  1.37    0.02 0.16 1.10 1.26 1.37 1.46  1.75    70 0.99 #> R[49]  1.33    0.02 0.15 1.10 1.23 1.31 1.43  1.62    77 0.99 #> R[50]  1.08    0.01 0.12 0.89 0.99 1.07 1.16  1.34   112 0.99 #> R[51]  0.92    0.01 0.12 0.66 0.85 0.92 1.00  1.13   129 0.99 #> R[52]  0.79    0.01 0.11 0.61 0.72 0.80 0.84  1.04    82 0.99 #> R[53]  0.69    0.01 0.10 0.52 0.62 0.68 0.75  0.86    92 0.99 #> R[54]  0.59    0.01 0.09 0.45 0.54 0.58 0.64  0.76   139 0.99 #> R[55]  0.53    0.01 0.08 0.38 0.47 0.52 0.58  0.70    82 1.06 #> R[56]  0.58    0.01 0.09 0.39 0.53 0.58 0.63  0.77   200 0.99 #> R[57]  0.45    0.01 0.07 0.31 0.41 0.46 0.50  0.59   110 0.99 #> R[58]  0.36    0.01 0.08 0.23 0.30 0.35 0.42  0.52    99 0.99 #> R[59]  0.32    0.01 0.08 0.19 0.25 0.31 0.37  0.47   187 0.99 #> R[60]  0.34    0.01 0.08 0.18 0.29 0.33 0.39  0.52   199 0.99 #> R[61]  0.28    0.01 0.07 0.17 0.23 0.28 0.32  0.44   127 1.01 #> R[62]  0.20    0.01 0.06 0.11 0.16 0.20 0.24  0.34   119 0.99 #> R[63]  0.15    0.01 0.05 0.07 0.11 0.14 0.18  0.27    97 1.00 #> R[64]  0.13    0.01 0.06 0.05 0.10 0.12 0.17  0.25   103 1.00 #> R[65]  0.11    0.01 0.06 0.04 0.06 0.10 0.14  0.23    17 1.14 #> R[66]  0.09    0.01 0.06 0.02 0.05 0.08 0.12  0.22    30 1.09 #> R[67]  0.09    0.01 0.05 0.02 0.06 0.09 0.12  0.21    59 1.00 #> R[68]  0.12    0.01 0.06 0.03 0.07 0.12 0.15  0.26    67 1.01 #> R[69]  0.16    0.01 0.08 0.04 0.11 0.15 0.21  0.32    76 1.01 #> R[70]  0.17    0.02 0.10 0.04 0.10 0.16 0.22  0.39    36 1.01 #> R[71]  0.17    0.02 0.10 0.03 0.10 0.14 0.22  0.45    35 0.99 #> R[72]  0.19    0.02 0.12 0.02 0.10 0.17 0.27  0.48    31 0.99 #> R[73]  0.24    0.02 0.12 0.09 0.15 0.23 0.30  0.54    30 0.99 #> R[74]  0.26    0.02 0.13 0.06 0.16 0.24 0.31  0.57    29 0.99 #> R[75]  0.29    0.02 0.13 0.09 0.18 0.29 0.38  0.56    30 1.00 #> R[76]  0.32    0.02 0.14 0.14 0.22 0.29 0.40  0.65    39 0.99 #> R[77]  0.36    0.02 0.15 0.14 0.24 0.35 0.43  0.67    56 1.00 #> R[78]  0.42    0.03 0.20 0.15 0.28 0.40 0.50  0.87    58 1.00 #> R[79]  0.48    0.03 0.23 0.19 0.31 0.43 0.60  0.98    64 1.01 #> R[80]  0.53    0.04 0.26 0.18 0.34 0.48 0.67  1.05    45 1.05 #> R[81]  0.56    0.04 0.27 0.20 0.36 0.51 0.73  1.10    39 1.09 #> R[82]  0.64    0.05 0.31 0.22 0.44 0.58 0.81  1.29    40 1.14 #> R[83]  0.70    0.06 0.34 0.25 0.45 0.63 0.88  1.53    33 1.17 #> R[84]  0.78    0.07 0.36 0.33 0.51 0.68 0.99  1.65    27 1.22 #> R[85]  0.81    0.08 0.38 0.31 0.53 0.75 1.02  1.70    24 1.25 #> R[86]  0.87    0.08 0.41 0.25 0.51 0.83 1.12  1.79    24 1.20 #> R[87]  0.94    0.08 0.46 0.33 0.58 0.85 1.22  2.10    30 1.14 #> R[88]  1.01    0.09 0.48 0.33 0.66 0.90 1.29  2.25    29 1.12 #> R[89]  1.09    0.09 0.47 0.34 0.73 1.04 1.37  2.15    28 1.11 #> R[90]  1.16    0.08 0.46 0.42 0.80 1.14 1.45  2.09    30 1.12 #> R[91]  1.28    0.09 0.47 0.41 0.95 1.25 1.59  2.27    25 1.12 #> R[92]  1.39    0.10 0.49 0.48 1.03 1.30 1.72  2.45    27 1.15 #> R[93]  1.48    0.08 0.48 0.62 1.14 1.41 1.81  2.54    33 1.11 #> R[94]  1.63    0.09 0.55 0.70 1.18 1.59 1.94  2.82    41 1.07 #> R[95]  1.77    0.08 0.52 0.91 1.38 1.75 2.04  2.93    46 1.07 #> R[96]  1.85    0.09 0.55 0.89 1.45 1.82 2.20  2.99    35 1.11 #> R[97]  1.93    0.09 0.54 1.05 1.52 1.90 2.22  2.95    34 1.10 #> R[98]  2.01    0.08 0.54 1.19 1.59 1.93 2.40  3.16    49 1.04 #> R[99]  2.12    0.08 0.56 1.22 1.76 2.02 2.49  3.34    51 1.05 #> R[100] 2.20    0.07 0.56 1.31 1.83 2.12 2.46  3.55    60 1.05 #> R[101] 2.28    0.07 0.55 1.42 1.87 2.20 2.68  3.42    62 1.05 #> R[102] 2.38    0.07 0.54 1.53 1.98 2.35 2.67  3.71    56 1.02 #> R[103] 2.42    0.06 0.50 1.58 2.07 2.42 2.77  3.66    70 1.02 #> R[104] 2.52    0.06 0.49 1.67 2.17 2.50 2.82  3.67    65 1.01 #> R[105] 2.48    0.05 0.46 1.65 2.15 2.46 2.75  3.55    81 0.99 #> R[106] 2.49    0.05 0.46 1.68 2.16 2.44 2.78  3.44    83 0.99 #> R[107] 2.45    0.04 0.44 1.73 2.14 2.40 2.70  3.33   115 1.01 #> R[108] 2.45    0.04 0.38 1.71 2.23 2.46 2.64  3.31    77 1.02 #> R[109] 2.41    0.04 0.37 1.85 2.14 2.34 2.64  3.23    71 1.01 #> R[110] 2.42    0.03 0.32 1.86 2.22 2.41 2.63  3.06    94 1.00 #> R[111] 2.44    0.03 0.32 1.75 2.26 2.47 2.62  2.99   110 0.99 #> R[112] 2.47    0.03 0.38 1.68 2.24 2.47 2.72  3.15   155 0.99 #> R[113] 2.51    0.03 0.35 1.96 2.26 2.48 2.75  3.27   127 1.00 #> R[114] 2.55    0.03 0.32 2.04 2.32 2.52 2.76  3.20   124 0.99 #> R[115] 2.73    0.03 0.37 2.06 2.46 2.70 2.96  3.45   115 0.99 #> R[116] 2.77    0.04 0.39 2.08 2.46 2.77 3.02  3.60   114 1.01 #> R[117] 2.75    0.03 0.39 2.15 2.42 2.72 3.05  3.40   148 0.99 #> R[118] 2.73    0.03 0.35 2.12 2.43 2.75 2.98  3.40    99 0.99 #> R[119] 2.69    0.03 0.32 2.10 2.45 2.71 2.90  3.33   111 0.99 #> R[120] 2.68    0.03 0.32 2.11 2.43 2.71 2.86  3.28    90 1.02 #> R[121] 2.85    0.03 0.27 2.37 2.63 2.82 3.04  3.40   101 0.99 #> R[122] 2.75    0.03 0.26 2.19 2.55 2.75 2.93  3.21   109 0.99 #> R[123] 2.54    0.02 0.23 2.18 2.35 2.54 2.67  3.03   111 1.00 #> R[124] 2.56    0.03 0.25 2.13 2.39 2.54 2.69  3.07    79 0.99 #> R[125] 2.44    0.02 0.19 2.12 2.31 2.44 2.60  2.81    98 0.99 #> R[126] 2.43    0.02 0.23 2.03 2.26 2.41 2.61  2.85   113 1.01 #> R[127] 2.45    0.02 0.20 2.09 2.33 2.42 2.60  2.78   120 1.00 #> R[128] 2.24    0.02 0.17 1.89 2.12 2.24 2.36  2.54    75 1.00 #> R[129] 1.94    0.02 0.18 1.56 1.83 1.95 2.06  2.31    90 1.00 #> R[130] 1.93    0.02 0.19 1.60 1.79 1.91 2.06  2.30    68 1.00 #> R[131] 1.80    0.02 0.15 1.53 1.72 1.79 1.88  2.10    72 1.01 #> R[132] 1.62    0.02 0.14 1.39 1.53 1.61 1.70  1.88    52 1.03 #> R[133] 1.54    0.01 0.11 1.31 1.47 1.54 1.61  1.75   129 1.01 #> R[134] 1.35    0.01 0.12 1.16 1.28 1.35 1.43  1.57    94 0.99 #> R[135] 1.12    0.01 0.10 0.93 1.04 1.11 1.19  1.33   106 0.99 #> R[136] 1.05    0.01 0.09 0.90 0.99 1.04 1.11  1.26   137 0.99 #> R[137] 1.00    0.01 0.08 0.84 0.95 0.99 1.05  1.16   159 1.00 #> R[138] 0.83    0.01 0.08 0.65 0.77 0.82 0.89  0.98    89 0.99 #> R[139] 0.79    0.01 0.07 0.67 0.75 0.79 0.82  0.92    87 0.99 #> R[140] 0.86    0.01 0.08 0.70 0.80 0.85 0.92  1.02    94 1.00 #> R[141] 0.81    0.01 0.07 0.69 0.76 0.80 0.85  0.93   133 0.99 #> R[142] 0.73    0.01 0.08 0.59 0.67 0.73 0.79  0.86    90 1.03 #> R[143] 0.73    0.01 0.07 0.62 0.68 0.73 0.78  0.86   116 0.99 #> R[144] 0.71    0.01 0.08 0.56 0.65 0.70 0.75  0.87    74 1.03 #> R[145] 0.67    0.01 0.08 0.56 0.62 0.67 0.73  0.84    48 1.03 #> R[146] 0.64    0.01 0.07 0.52 0.59 0.63 0.67  0.77   102 0.99 #> R[147] 0.48    0.01 0.05 0.37 0.45 0.48 0.51  0.58    97 0.99 #> R[148] 0.38    0.01 0.06 0.26 0.35 0.38 0.41  0.48   104 1.00 #> R[149] 0.27    0.01 0.05 0.17 0.24 0.27 0.30  0.37    96 1.01 #> R[150] 0.29    0.00 0.05 0.20 0.26 0.29 0.33  0.40   142 0.99 #> R[151] 0.29    0.00 0.06 0.20 0.25 0.28 0.33  0.41   142 0.99 #> R[152] 0.23    0.01 0.05 0.14 0.19 0.23 0.26  0.32    82 0.99 #> R[153] 0.17    0.00 0.04 0.10 0.14 0.17 0.20  0.25   123 0.99 #> R[154] 0.19    0.00 0.05 0.11 0.16 0.18 0.20  0.33   117 0.99 #> R[155] 0.13    0.00 0.05 0.05 0.09 0.12 0.16  0.24   176 1.01 #> R[156] 0.11    0.00 0.05 0.04 0.08 0.10 0.13  0.23   142 1.00 #> R[157] 0.14    0.00 0.05 0.05 0.10 0.14 0.16  0.23   105 1.01 #> R[158] 0.14    0.01 0.05 0.06 0.10 0.13 0.16  0.24   107 1.07 #> R[159] 0.15    0.01 0.06 0.04 0.11 0.13 0.18  0.26    84 1.03 #> R[160] 0.17    0.01 0.06 0.08 0.13 0.17 0.22  0.30   113 1.04 #> R[161] 0.16    0.01 0.07 0.05 0.12 0.16 0.21  0.31    77 0.99 #> R[162] 0.19    0.01 0.07 0.07 0.13 0.18 0.24  0.33    60 1.02 #> R[163] 0.23    0.01 0.09 0.09 0.16 0.23 0.29  0.42    79 0.99 #> R[164] 0.34    0.01 0.11 0.14 0.24 0.34 0.41  0.59    78 1.01 #> R[165] 0.42    0.01 0.13 0.22 0.33 0.42 0.49  0.71    80 0.99 #> R[166] 0.48    0.02 0.16 0.22 0.37 0.47 0.57  0.81    80 0.99 #> R[167] 0.52    0.02 0.17 0.26 0.39 0.48 0.63  0.84   113 0.99 #> R[168] 0.55    0.03 0.20 0.23 0.41 0.52 0.64  0.97    56 1.00 #> R[169] 0.64    0.02 0.21 0.30 0.49 0.62 0.79  1.09    92 1.01 #> R[170] 0.73    0.02 0.22 0.34 0.59 0.71 0.87  1.18    83 1.00 #> R[171] 0.84    0.03 0.26 0.34 0.67 0.78 1.05  1.32    81 0.99 #> R[172] 0.92    0.04 0.28 0.49 0.68 0.90 1.12  1.51    61 0.99 #> R[173] 1.01    0.03 0.26 0.54 0.85 1.03 1.16  1.52    72 1.00 #> R[174] 1.05    0.04 0.30 0.52 0.86 1.06 1.23  1.67    69 0.99 #> R[175] 1.13    0.04 0.33 0.59 0.88 1.13 1.36  1.85    67 0.99 #> R[176] 1.21    0.04 0.33 0.67 0.96 1.18 1.44  1.88    74 0.99 #> R[177] 1.27    0.03 0.32 0.75 1.08 1.26 1.45  2.02    90 0.99 #> R[178] 1.26    0.03 0.33 0.76 1.05 1.22 1.46  2.06    95 1.00 #> R[179] 1.33    0.04 0.34 0.70 1.13 1.31 1.50  2.05    93 1.01 #> R[180] 1.42    0.04 0.36 0.89 1.13 1.38 1.66  2.13    97 1.01 #> R[181] 1.51    0.04 0.37 0.96 1.24 1.48 1.72  2.36   108 1.03 #> R[182] 1.62    0.03 0.36 1.05 1.37 1.60 1.83  2.40   114 1.01 #> R[183] 1.78    0.03 0.40 1.14 1.49 1.70 2.01  2.67   160 1.02 #> R[184] 2.03    0.03 0.37 1.38 1.79 1.99 2.26  3.00   123 1.02 #> R[185] 2.20    0.03 0.34 1.53 2.01 2.19 2.40  2.95   111 1.05 #> R[186] 2.32    0.03 0.38 1.67 2.09 2.29 2.55  3.12   179 1.03 #> R[187] 2.54    0.03 0.37 1.94 2.29 2.49 2.76  3.24   181 0.99 #> R[188] 2.74    0.03 0.33 2.17 2.51 2.70 2.96  3.50   157 0.99 #> R[189] 2.82    0.04 0.35 2.28 2.53 2.79 3.09  3.55    89 1.00 #> R[190] 2.83    0.04 0.40 2.13 2.53 2.78 3.19  3.51    99 0.99 #> R[191] 2.84    0.04 0.37 2.17 2.53 2.80 3.14  3.49   109 0.99 #> R[192] 2.90    0.03 0.32 2.34 2.68 2.84 3.15  3.49   106 0.99 #> R[193] 2.93    0.02 0.31 2.38 2.71 2.93 3.16  3.50   167 0.99 #> R[194] 2.90    0.02 0.29 2.21 2.72 2.95 3.06  3.44   153 0.99 #> R[195] 3.05    0.04 0.29 2.47 2.87 3.04 3.25  3.71    68 1.00 #> R[196] 3.11    0.02 0.25 2.61 2.98 3.10 3.28  3.63   106 1.00 #> R[197] 3.00    0.03 0.27 2.56 2.82 2.98 3.19  3.50   112 1.00 #> R[198] 3.23    0.02 0.27 2.69 3.05 3.23 3.47  3.64   153 1.01 #> R[199] 3.57    0.03 0.29 2.97 3.35 3.57 3.79  4.09   103 0.99 #> R[200] 3.81    0.04 0.31 3.21 3.59 3.85 4.03  4.37    79 0.99 #>  #> Samples were drawn using NUTS(diag_e) at Thu Oct  3 17:01:24 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1). # extract posterior quantiles R_draws <- rstan::extract(fit, \"R\")[[1]] lower <- apply(R_draws, 2, function(x) quantile(x, 0.025)) middle <- apply(R_draws, 2, function(x) quantile(x, 0.5)) upper <- apply(R_draws, 2, function(x) quantile(x, 0.975))  # plot epidemic_df %>%    mutate(     lower=lower,     middle=middle,     upper=upper   ) %>%    select(t, R_t, lower, middle, upper) %>%    ggplot(aes(x=t, y=R_t)) +   geom_line(colour=\"red\") +   geom_ribbon(aes(ymin=lower, ymax=upper), fill=\"blue\", alpha=0.4) +   geom_line(aes(y=middle))"},{"path":"https://ben18785.github.io/epidp/articles/fitting_synthetic_data_using_epidp.html","id":"step-function-in-r_t","dir":"Articles","previous_headings":"","what":"Step function in RtR_t","title":"Fitting synthetic data using epidp","text":"first generate case data assuming step function RtR_t.  now use Stan version EpiFilter estimate maximum posteriori estimates RtR_t overlay top actual values. Note, estimates uncertainty associated benefit estimation instantaneous. estimates close actual RtR_t values initial period case counts low.","code":"rt_fun = function(t){   if(t <= 60)     R = 2   else if (t <= 90)     R = 0.5   else     R = 1   R }  # simulation parameters nt <- 200 mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0)  # plot transform_factor <- 300 epidemic_df %>%   select(-c(w_dist, lambda_t)) %>%   mutate(R_t = R_t * transform_factor) %>%    pivot_longer(c(i_t, R_t)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / transform_factor, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\") +   theme_minimal() +   scale_color_brewer(\"Series\", palette = \"Dark2\") # fit model fit <- fit_epifilter(   N=length(epidemic_df$i_t),   C=epidemic_df$i_t,   w=epidemic_df$w_dist,   is_sampling=FALSE,   as_vector=FALSE )  # plot R <- fit$par$R epidemic_df %>%    mutate(estimated=R) %>%    rename(true=R_t) %>%    select(t, estimated, true) %>%    pivot_longer(c(estimated, true)) %>%    ggplot(aes(x=t, y=value)) +   geom_line(aes(colour=name)) +   scale_color_brewer(\"R_t\", palette = \"Dark2\") +   ylab(\"R_t\")"},{"path":"https://ben18785.github.io/epidp/articles/fitting_synthetic_data_using_epidp.html","id":"sinusoidal-function-in-r_t","dir":"Articles","previous_headings":"","what":"Sinusoidal function in RtR_t","title":"Fitting synthetic data using epidp","text":"now generate case data assuming sinusoidal RtR_t.  now use Stan version EpiFilter estimate RtR_t profile. now overlay estimated RtR_t versus actual values. estimated RtR_t values coincide reasonably true values.","code":"# define sinusoidal Rt rt_fun <- function(t) {   1.3 + 1.2 * sin(4 * (pi / 180) * t) } nt <- 200 mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0)  # plot transform_factor <- 150 epidemic_df %>%   select(-c(w_dist, lambda_t)) %>%   mutate(R_t = R_t * transform_factor) %>%    pivot_longer(c(i_t, R_t)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / transform_factor, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\") +   theme_minimal() +   scale_color_brewer(\"Series\", palette = \"Dark2\") # fit model fit <- fit_epifilter(   N=length(epidemic_df$i_t),   C=epidemic_df$i_t,   w=epidemic_df$w_dist,   iter=200 ) #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.001504 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 15.04 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: WARNING: There aren't enough warmup iterations to fit the #> Chain 1:          three stages of adaptation as currently configured. #> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 1:          the given number of warmup iterations: #> Chain 1:            init_buffer = 15 #> Chain 1:            adapt_window = 75 #> Chain 1:            term_buffer = 10 #> Chain 1:  #> Chain 1: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 1: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 1: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 1: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 1: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 1: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 1: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 1: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 1: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 1: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 1: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 1: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 10.866 seconds (Warm-up) #> Chain 1:                11.097 seconds (Sampling) #> Chain 1:                21.963 seconds (Total) #> Chain 1:  #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 2). #> Chain 2:  #> Chain 2: Gradient evaluation took 0.001284 seconds #> Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 12.84 seconds. #> Chain 2: Adjust your expectations accordingly! #> Chain 2:  #> Chain 2:  #> Chain 2: WARNING: There aren't enough warmup iterations to fit the #> Chain 2:          three stages of adaptation as currently configured. #> Chain 2:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 2:          the given number of warmup iterations: #> Chain 2:            init_buffer = 15 #> Chain 2:            adapt_window = 75 #> Chain 2:            term_buffer = 10 #> Chain 2:  #> Chain 2: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 2: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 2: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 2: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 2: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 2: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 2: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 2: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 2: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 2: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 2: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 2: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 2:  #> Chain 2:  Elapsed Time: 12.097 seconds (Warm-up) #> Chain 2:                10.737 seconds (Sampling) #> Chain 2:                22.834 seconds (Total) #> Chain 2:  #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 3). #> Chain 3:  #> Chain 3: Gradient evaluation took 0.00131 seconds #> Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 13.1 seconds. #> Chain 3: Adjust your expectations accordingly! #> Chain 3:  #> Chain 3:  #> Chain 3: WARNING: There aren't enough warmup iterations to fit the #> Chain 3:          three stages of adaptation as currently configured. #> Chain 3:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 3:          the given number of warmup iterations: #> Chain 3:            init_buffer = 15 #> Chain 3:            adapt_window = 75 #> Chain 3:            term_buffer = 10 #> Chain 3:  #> Chain 3: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 3: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 3: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 3: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 3: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 3: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 3: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 3: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 3: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 3: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 3: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 3: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 3:  #> Chain 3:  Elapsed Time: 11.266 seconds (Warm-up) #> Chain 3:                11.366 seconds (Sampling) #> Chain 3:                22.632 seconds (Total) #> Chain 3:  #>  #> SAMPLING FOR MODEL 'epifilter' NOW (CHAIN 4). #> Chain 4:  #> Chain 4: Gradient evaluation took 0.001294 seconds #> Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 12.94 seconds. #> Chain 4: Adjust your expectations accordingly! #> Chain 4:  #> Chain 4:  #> Chain 4: WARNING: There aren't enough warmup iterations to fit the #> Chain 4:          three stages of adaptation as currently configured. #> Chain 4:          Reducing each adaptation stage to 15%/75%/10% of #> Chain 4:          the given number of warmup iterations: #> Chain 4:            init_buffer = 15 #> Chain 4:            adapt_window = 75 #> Chain 4:            term_buffer = 10 #> Chain 4:  #> Chain 4: Iteration:   1 / 200 [  0%]  (Warmup) #> Chain 4: Iteration:  20 / 200 [ 10%]  (Warmup) #> Chain 4: Iteration:  40 / 200 [ 20%]  (Warmup) #> Chain 4: Iteration:  60 / 200 [ 30%]  (Warmup) #> Chain 4: Iteration:  80 / 200 [ 40%]  (Warmup) #> Chain 4: Iteration: 100 / 200 [ 50%]  (Warmup) #> Chain 4: Iteration: 101 / 200 [ 50%]  (Sampling) #> Chain 4: Iteration: 120 / 200 [ 60%]  (Sampling) #> Chain 4: Iteration: 140 / 200 [ 70%]  (Sampling) #> Chain 4: Iteration: 160 / 200 [ 80%]  (Sampling) #> Chain 4: Iteration: 180 / 200 [ 90%]  (Sampling) #> Chain 4: Iteration: 200 / 200 [100%]  (Sampling) #> Chain 4:  #> Chain 4:  Elapsed Time: 11.477 seconds (Warm-up) #> Chain 4:                10.914 seconds (Sampling) #> Chain 4:                22.391 seconds (Total) #> Chain 4: #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # look at MCMC summaries print(fit, c(\"sigma\", \"R\")) #> Inference for Stan model: epifilter. #> 4 chains, each with iter=200; warmup=100; thin=1;  #> post-warmup draws per chain=100, total post-warmup draws=400. #>  #>        mean se_mean   sd 2.5%  25%  50%  75% 97.5% n_eff Rhat #> sigma  0.14    0.00 0.01 0.12 0.13 0.14 0.14  0.17   107 1.03 #> R[1]   1.41    0.05 0.45 0.62 1.11 1.40 1.67  2.35    75 1.06 #> R[2]   1.42    0.05 0.41 0.64 1.17 1.43 1.66  2.28    68 1.07 #> R[3]   1.43    0.05 0.39 0.76 1.16 1.43 1.64  2.28    64 1.07 #> R[4]   1.43    0.04 0.37 0.78 1.17 1.41 1.66  2.19    82 1.06 #> R[5]   1.44    0.04 0.35 0.85 1.19 1.42 1.67  2.17   101 1.06 #> R[6]   1.50    0.04 0.33 0.90 1.26 1.46 1.72  2.18    69 1.07 #> R[7]   1.57    0.04 0.32 0.99 1.35 1.54 1.77  2.24    77 1.06 #> R[8]   1.62    0.03 0.33 1.03 1.42 1.58 1.81  2.32   106 1.05 #> R[9]   1.68    0.02 0.34 1.09 1.46 1.64 1.87  2.39   182 1.03 #> R[10]  1.76    0.03 0.33 1.20 1.54 1.74 1.96  2.48   168 1.03 #> R[11]  1.82    0.02 0.33 1.25 1.57 1.78 2.03  2.54   180 1.03 #> R[12]  1.84    0.02 0.31 1.31 1.63 1.81 2.07  2.46   258 1.02 #> R[13]  1.89    0.02 0.30 1.39 1.68 1.86 2.09  2.50   288 1.02 #> R[14]  1.97    0.02 0.32 1.43 1.74 1.94 2.19  2.61   351 1.01 #> R[15]  2.04    0.01 0.32 1.46 1.81 2.03 2.25  2.65   488 1.00 #> R[16]  2.08    0.02 0.32 1.48 1.87 2.06 2.29  2.75   451 1.00 #> R[17]  2.14    0.01 0.30 1.59 1.92 2.12 2.35  2.73   420 0.99 #> R[18]  2.22    0.01 0.28 1.70 2.02 2.21 2.40  2.76   457 0.99 #> R[19]  2.29    0.01 0.27 1.79 2.10 2.29 2.49  2.81   490 1.00 #> R[20]  2.40    0.01 0.27 1.88 2.23 2.40 2.55  3.02   551 1.00 #> R[21]  2.50    0.01 0.26 1.99 2.31 2.50 2.68  3.02   449 1.00 #> R[22]  2.63    0.01 0.27 2.14 2.44 2.60 2.81  3.18   496 0.99 #> R[23]  2.63    0.01 0.26 2.15 2.45 2.62 2.81  3.12   418 0.99 #> R[24]  2.62    0.01 0.26 2.15 2.46 2.61 2.78  3.19   415 1.00 #> R[25]  2.54    0.01 0.23 2.07 2.38 2.54 2.69  3.02   448 1.00 #> R[26]  2.52    0.01 0.21 2.14 2.36 2.52 2.66  2.97   672 1.00 #> R[27]  2.59    0.01 0.21 2.21 2.44 2.59 2.73  3.00   475 1.00 #> R[28]  2.45    0.01 0.21 2.07 2.32 2.44 2.60  2.86   599 0.99 #> R[29]  2.28    0.01 0.19 1.94 2.16 2.28 2.40  2.67   499 0.99 #> R[30]  2.21    0.01 0.17 1.90 2.09 2.20 2.31  2.56   417 1.00 #> R[31]  2.16    0.01 0.16 1.89 2.05 2.16 2.26  2.46   419 1.00 #> R[32]  2.11    0.01 0.15 1.82 2.01 2.10 2.20  2.46   472 1.00 #> R[33]  2.19    0.01 0.16 1.91 2.09 2.19 2.28  2.55   355 1.00 #> R[34]  2.08    0.01 0.15 1.82 1.98 2.07 2.19  2.36   414 1.00 #> R[35]  1.91    0.01 0.14 1.64 1.82 1.91 2.01  2.21   398 0.99 #> R[36]  1.87    0.01 0.13 1.62 1.78 1.85 1.96  2.12   303 1.00 #> R[37]  1.82    0.01 0.13 1.58 1.74 1.81 1.91  2.10   401 1.01 #> R[38]  1.84    0.01 0.12 1.61 1.77 1.85 1.92  2.06   429 0.99 #> R[39]  1.74    0.01 0.11 1.52 1.66 1.74 1.81  1.99   358 1.00 #> R[40]  1.59    0.00 0.10 1.39 1.52 1.58 1.65  1.79   405 1.00 #> R[41]  1.59    0.00 0.09 1.42 1.52 1.58 1.66  1.77   383 1.01 #> R[42]  1.50    0.00 0.10 1.32 1.43 1.50 1.57  1.69   491 1.00 #> R[43]  1.35    0.00 0.10 1.17 1.28 1.34 1.40  1.54   375 0.99 #> R[44]  1.47    0.00 0.09 1.29 1.41 1.47 1.54  1.66   392 0.99 #> R[45]  1.35    0.00 0.08 1.20 1.29 1.34 1.41  1.52   416 1.00 #> R[46]  1.37    0.00 0.09 1.22 1.32 1.37 1.43  1.54   463 0.99 #> R[47]  1.30    0.00 0.08 1.15 1.25 1.30 1.36  1.46   366 1.01 #> R[48]  1.14    0.00 0.07 1.00 1.09 1.13 1.19  1.29   414 0.99 #> R[49]  1.03    0.00 0.07 0.89 0.98 1.03 1.07  1.17   489 1.00 #> R[50]  0.89    0.00 0.07 0.76 0.84 0.89 0.94  1.02   379 1.00 #> R[51]  0.82    0.00 0.06 0.71 0.78 0.82 0.86  0.94   434 1.00 #> R[52]  0.79    0.00 0.06 0.66 0.75 0.79 0.83  0.90   407 1.00 #> R[53]  0.61    0.00 0.06 0.50 0.57 0.61 0.65  0.73   328 1.00 #> R[54]  0.60    0.00 0.06 0.50 0.56 0.60 0.64  0.72   683 1.00 #> R[55]  0.56    0.00 0.05 0.46 0.52 0.56 0.59  0.66   351 1.00 #> R[56]  0.45    0.00 0.05 0.36 0.43 0.45 0.48  0.54   458 0.99 #> R[57]  0.42    0.00 0.05 0.33 0.39 0.42 0.45  0.53   421 1.00 #> R[58]  0.34    0.00 0.04 0.26 0.31 0.34 0.37  0.42   432 1.00 #> R[59]  0.23    0.00 0.04 0.17 0.21 0.23 0.26  0.31   475 1.00 #> R[60]  0.22    0.00 0.04 0.16 0.19 0.22 0.24  0.30   482 1.00 #> R[61]  0.18    0.00 0.04 0.12 0.16 0.18 0.21  0.26   609 0.99 #> R[62]  0.17    0.00 0.03 0.12 0.15 0.17 0.20  0.24   599 0.99 #> R[63]  0.17    0.00 0.04 0.10 0.14 0.17 0.19  0.26   613 0.99 #> R[64]  0.12    0.00 0.03 0.07 0.10 0.12 0.14  0.19   575 1.00 #> R[65]  0.12    0.00 0.04 0.06 0.09 0.11 0.14  0.20   500 1.01 #> R[66]  0.09    0.00 0.03 0.04 0.07 0.09 0.11  0.17   374 1.01 #> R[67]  0.09    0.00 0.04 0.03 0.07 0.09 0.12  0.19   260 1.01 #> R[68]  0.13    0.00 0.05 0.05 0.09 0.12 0.15  0.24   294 1.00 #> R[69]  0.14    0.00 0.05 0.06 0.11 0.14 0.17  0.26   327 1.01 #> R[70]  0.17    0.00 0.06 0.06 0.13 0.16 0.21  0.30   336 1.01 #> R[71]  0.19    0.00 0.07 0.08 0.14 0.19 0.24  0.33   297 1.01 #> R[72]  0.24    0.00 0.08 0.11 0.18 0.23 0.30  0.43   294 1.00 #> R[73]  0.25    0.01 0.09 0.10 0.18 0.24 0.30  0.44   290 1.01 #> R[74]  0.28    0.01 0.10 0.11 0.21 0.26 0.34  0.51   293 0.99 #> R[75]  0.31    0.01 0.11 0.13 0.24 0.30 0.38  0.55   245 1.00 #> R[76]  0.36    0.01 0.12 0.18 0.29 0.34 0.43  0.62   266 0.99 #> R[77]  0.45    0.01 0.13 0.22 0.36 0.45 0.54  0.75   231 0.99 #> R[78]  0.54    0.01 0.15 0.29 0.45 0.53 0.62  0.90   236 1.00 #> R[79]  0.62    0.01 0.17 0.33 0.50 0.59 0.71  1.00   224 1.00 #> R[80]  0.67    0.01 0.17 0.38 0.56 0.66 0.77  1.06   218 1.00 #> R[81]  0.74    0.01 0.19 0.41 0.62 0.72 0.85  1.15   239 1.00 #> R[82]  0.83    0.01 0.21 0.45 0.69 0.82 0.95  1.30   230 0.99 #> R[83]  0.94    0.01 0.21 0.58 0.78 0.92 1.10  1.37   207 1.00 #> R[84]  1.03    0.01 0.23 0.63 0.86 1.01 1.18  1.53   267 0.99 #> R[85]  1.13    0.01 0.23 0.69 0.97 1.13 1.28  1.55   302 0.99 #> R[86]  1.23    0.01 0.26 0.72 1.05 1.24 1.40  1.77   333 0.99 #> R[87]  1.33    0.01 0.26 0.85 1.15 1.32 1.49  1.86   340 0.99 #> R[88]  1.40    0.01 0.27 0.86 1.24 1.40 1.58  1.96   342 1.00 #> R[89]  1.44    0.01 0.26 0.92 1.27 1.43 1.63  1.97   380 1.00 #> R[90]  1.50    0.01 0.26 1.03 1.32 1.48 1.67  2.00   351 1.00 #> R[91]  1.52    0.01 0.27 1.04 1.36 1.49 1.67  2.05   417 1.00 #> R[92]  1.50    0.01 0.26 1.04 1.33 1.50 1.66  2.03   412 1.00 #> R[93]  1.53    0.01 0.26 1.07 1.37 1.51 1.70  2.11   446 1.00 #> R[94]  1.58    0.01 0.26 1.13 1.40 1.55 1.75  2.13   532 1.00 #> R[95]  1.64    0.01 0.28 1.16 1.44 1.62 1.82  2.20   502 1.00 #> R[96]  1.70    0.01 0.28 1.21 1.51 1.68 1.88  2.30   526 1.00 #> R[97]  1.82    0.01 0.27 1.33 1.65 1.80 2.00  2.37   518 1.01 #> R[98]  1.88    0.01 0.26 1.37 1.70 1.86 2.04  2.41   469 1.00 #> R[99]  1.92    0.01 0.28 1.45 1.72 1.91 2.10  2.49   518 0.99 #> R[100] 1.94    0.01 0.27 1.43 1.75 1.96 2.13  2.44   492 1.00 #> R[101] 2.05    0.01 0.27 1.50 1.88 2.05 2.23  2.57   623 0.99 #> R[102] 2.13    0.01 0.26 1.64 1.94 2.12 2.31  2.63   580 0.99 #> R[103] 2.18    0.01 0.27 1.73 2.00 2.15 2.35  2.77   620 0.99 #> R[104] 2.26    0.01 0.24 1.82 2.08 2.23 2.45  2.76   583 1.00 #> R[105] 2.23    0.01 0.24 1.77 2.07 2.23 2.40  2.74   507 1.00 #> R[106] 2.20    0.01 0.23 1.75 2.05 2.20 2.37  2.63   538 0.99 #> R[107] 2.25    0.01 0.22 1.84 2.10 2.24 2.40  2.67   442 0.99 #> R[108] 2.40    0.01 0.22 2.01 2.25 2.40 2.54  2.83   509 0.99 #> R[109] 2.56    0.01 0.22 2.16 2.41 2.56 2.71  3.02   434 1.01 #> R[110] 2.58    0.01 0.20 2.18 2.45 2.58 2.72  3.01   395 0.99 #> R[111] 2.60    0.01 0.19 2.20 2.46 2.60 2.72  3.00   339 1.00 #> R[112] 2.42    0.01 0.19 2.05 2.27 2.42 2.54  2.81   391 1.01 #> R[113] 2.43    0.01 0.19 2.08 2.30 2.42 2.54  2.82   426 1.00 #> R[114] 2.52    0.01 0.17 2.16 2.40 2.51 2.64  2.86   377 0.99 #> R[115] 2.54    0.01 0.17 2.20 2.43 2.53 2.65  2.88   485 0.99 #> R[116] 2.51    0.01 0.15 2.22 2.40 2.50 2.60  2.82   277 1.00 #> R[117] 2.31    0.01 0.16 2.03 2.21 2.31 2.42  2.61   315 0.99 #> R[118] 2.41    0.01 0.14 2.16 2.32 2.41 2.51  2.71   380 1.00 #> R[119] 2.48    0.01 0.15 2.21 2.38 2.46 2.56  2.78   396 1.00 #> R[120] 2.32    0.01 0.12 2.08 2.25 2.33 2.40  2.56   422 1.00 #> R[121] 2.20    0.01 0.12 1.99 2.11 2.19 2.28  2.44   410 1.00 #> R[122] 2.19    0.01 0.11 2.00 2.12 2.19 2.27  2.43   409 1.00 #> R[123] 2.10    0.01 0.11 1.89 2.03 2.11 2.17  2.30   419 0.99 #> R[124] 2.07    0.01 0.10 1.90 2.01 2.07 2.13  2.28   358 1.00 #> R[125] 2.01    0.00 0.10 1.83 1.94 2.00 2.08  2.19   426 1.00 #> R[126] 1.90    0.00 0.09 1.74 1.84 1.90 1.96  2.07   361 1.00 #> R[127] 1.95    0.00 0.09 1.77 1.89 1.95 2.01  2.13   445 1.00 #> R[128] 1.89    0.00 0.08 1.75 1.84 1.89 1.95  2.06   308 1.00 #> R[129] 1.80    0.00 0.08 1.66 1.74 1.79 1.86  1.95   376 1.00 #> R[130] 1.75    0.00 0.08 1.60 1.70 1.74 1.80  1.90   382 1.00 #> R[131] 1.69    0.00 0.07 1.57 1.65 1.69 1.74  1.82   409 1.01 #> R[132] 1.49    0.00 0.06 1.37 1.45 1.49 1.53  1.62   381 1.00 #> R[133] 1.44    0.00 0.06 1.34 1.40 1.44 1.48  1.56   343 0.99 #> R[134] 1.31    0.00 0.06 1.19 1.28 1.32 1.35  1.42   432 1.00 #> R[135] 1.36    0.00 0.05 1.26 1.33 1.36 1.40  1.46   351 1.00 #> R[136] 1.29    0.00 0.05 1.19 1.26 1.29 1.33  1.40   375 1.00 #> R[137] 1.12    0.00 0.05 1.04 1.09 1.12 1.15  1.22   414 0.99 #> R[138] 1.02    0.00 0.05 0.94 0.99 1.02 1.05  1.12   329 1.00 #> R[139] 0.93    0.00 0.04 0.85 0.90 0.93 0.96  1.02   432 1.00 #> R[140] 0.86    0.00 0.04 0.78 0.84 0.86 0.90  0.95   406 0.99 #> R[141] 0.85    0.00 0.04 0.77 0.82 0.84 0.87  0.93   444 0.99 #> R[142] 0.80    0.00 0.04 0.72 0.77 0.80 0.82  0.88   318 1.01 #> R[143] 0.67    0.00 0.04 0.60 0.65 0.67 0.70  0.73   423 0.99 #> R[144] 0.61    0.00 0.03 0.55 0.59 0.62 0.64  0.68   424 0.99 #> R[145] 0.48    0.00 0.03 0.42 0.45 0.48 0.50  0.54   349 1.00 #> R[146] 0.42    0.00 0.03 0.36 0.40 0.41 0.43  0.47   441 1.00 #> R[147] 0.40    0.00 0.03 0.34 0.38 0.40 0.42  0.47   459 1.00 #> R[148] 0.37    0.00 0.03 0.31 0.35 0.37 0.39  0.42   381 1.00 #> R[149] 0.32    0.00 0.03 0.26 0.30 0.32 0.34  0.37   404 1.00 #> R[150] 0.26    0.00 0.03 0.21 0.24 0.25 0.27  0.31   257 1.00 #> R[151] 0.20    0.00 0.02 0.16 0.19 0.20 0.22  0.25   465 0.99 #> R[152] 0.21    0.00 0.03 0.16 0.19 0.20 0.23  0.26   517 1.00 #> R[153] 0.17    0.00 0.02 0.13 0.15 0.17 0.18  0.22   408 1.01 #> R[154] 0.13    0.00 0.02 0.09 0.12 0.13 0.15  0.17   519 1.00 #> R[155] 0.12    0.00 0.02 0.08 0.10 0.12 0.13  0.17   509 0.99 #> R[156] 0.09    0.00 0.02 0.05 0.07 0.08 0.10  0.13   587 1.00 #> R[157] 0.09    0.00 0.02 0.05 0.08 0.09 0.11  0.14   807 0.99 #> R[158] 0.11    0.00 0.03 0.06 0.09 0.11 0.12  0.16   566 1.00 #> R[159] 0.11    0.00 0.03 0.06 0.09 0.10 0.12  0.17   409 0.99 #> R[160] 0.10    0.00 0.03 0.05 0.08 0.10 0.12  0.17   423 0.99 #> R[161] 0.12    0.00 0.04 0.05 0.09 0.12 0.14  0.20   466 0.99 #> R[162] 0.12    0.00 0.04 0.05 0.09 0.12 0.15  0.20   455 0.99 #> R[163] 0.16    0.00 0.05 0.09 0.13 0.16 0.19  0.27   380 1.00 #> R[164] 0.17    0.00 0.05 0.08 0.14 0.17 0.21  0.27   349 1.01 #> R[165] 0.21    0.00 0.07 0.11 0.16 0.20 0.25  0.37   286 1.00 #> R[166] 0.22    0.00 0.07 0.10 0.17 0.21 0.27  0.39   362 1.00 #> R[167] 0.28    0.00 0.09 0.14 0.22 0.27 0.33  0.47   340 1.00 #> R[168] 0.33    0.01 0.10 0.17 0.25 0.32 0.39  0.55   371 1.00 #> R[169] 0.44    0.01 0.11 0.24 0.36 0.43 0.50  0.70   363 1.00 #> R[170] 0.49    0.01 0.13 0.27 0.40 0.48 0.56  0.76   345 1.00 #> R[171] 0.56    0.01 0.14 0.31 0.46 0.55 0.64  0.85   319 1.01 #> R[172] 0.65    0.01 0.15 0.35 0.54 0.65 0.75  0.98   301 1.00 #> R[173] 0.77    0.01 0.17 0.45 0.65 0.77 0.88  1.13   426 1.00 #> R[174] 0.89    0.01 0.18 0.58 0.76 0.89 1.01  1.24   495 1.00 #> R[175] 0.96    0.01 0.19 0.63 0.82 0.94 1.08  1.35   575 0.99 #> R[176] 1.05    0.01 0.20 0.70 0.91 1.02 1.18  1.43   548 0.99 #> R[177] 1.13    0.01 0.21 0.74 0.99 1.12 1.26  1.56   486 1.00 #> R[178] 1.19    0.01 0.21 0.83 1.04 1.18 1.32  1.64   465 0.99 #> R[179] 1.28    0.01 0.22 0.92 1.13 1.25 1.40  1.79   540 0.99 #> R[180] 1.30    0.01 0.21 0.92 1.15 1.30 1.45  1.75   524 1.00 #> R[181] 1.36    0.01 0.22 0.95 1.20 1.36 1.50  1.79   503 1.00 #> R[182] 1.47    0.01 0.24 1.02 1.32 1.46 1.62  1.97   570 1.00 #> R[183] 1.56    0.01 0.23 1.14 1.41 1.55 1.71  2.01   555 1.00 #> R[184] 1.68    0.01 0.24 1.25 1.51 1.68 1.83  2.17   583 1.00 #> R[185] 1.82    0.01 0.23 1.40 1.66 1.81 1.98  2.31   691 0.99 #> R[186] 1.85    0.01 0.23 1.44 1.67 1.85 2.00  2.30   675 0.99 #> R[187] 1.87    0.01 0.24 1.44 1.69 1.87 2.04  2.34   620 0.99 #> R[188] 1.96    0.01 0.24 1.53 1.80 1.97 2.13  2.40   663 0.99 #> R[189] 2.05    0.01 0.24 1.61 1.89 2.03 2.21  2.52   570 1.00 #> R[190] 2.02    0.01 0.23 1.60 1.85 2.01 2.18  2.52   568 0.99 #> R[191] 2.01    0.01 0.23 1.62 1.85 2.00 2.16  2.48   735 0.99 #> R[192] 2.03    0.01 0.22 1.64 1.89 2.01 2.17  2.46   764 0.99 #> R[193] 2.11    0.01 0.22 1.68 1.97 2.10 2.26  2.61   595 1.00 #> R[194] 2.23    0.01 0.21 1.83 2.09 2.23 2.36  2.70   482 1.00 #> R[195] 2.28    0.01 0.21 1.84 2.14 2.26 2.41  2.75   670 1.00 #> R[196] 2.35    0.01 0.21 1.99 2.22 2.34 2.49  2.77   540 0.99 #> R[197] 2.42    0.01 0.20 2.06 2.29 2.41 2.56  2.81   470 1.00 #> R[198] 2.30    0.01 0.19 1.92 2.17 2.29 2.43  2.68   469 0.99 #> R[199] 2.31    0.01 0.19 1.93 2.18 2.31 2.42  2.71   588 1.00 #> R[200] 2.20    0.01 0.20 1.83 2.06 2.19 2.33  2.62   447 0.99 #>  #> Samples were drawn using NUTS(diag_e) at Thu Oct  3 17:03:02 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1). # extract posterior quantiles R_draws <- rstan::extract(fit, \"R\")[[1]] lower <- apply(R_draws, 2, function(x) quantile(x, 0.025)) middle <- apply(R_draws, 2, function(x) quantile(x, 0.5)) upper <- apply(R_draws, 2, function(x) quantile(x, 0.975))  # plot epidemic_df %>%    mutate(     lower=lower,     middle=middle,     upper=upper   ) %>%    select(t, R_t, lower, middle, upper) %>%    ggplot(aes(x=t, y=R_t)) +   geom_line(colour=\"red\") +   geom_ribbon(aes(ymin=lower, ymax=upper), fill=\"blue\", alpha=0.4) +   geom_line(aes(y=middle))"},{"path":"https://ben18785.github.io/epidp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ben Lambert. Author, maintainer. Kris Parag. Author.","code":""},{"path":"https://ben18785.github.io/epidp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lambert B, Parag K (2024). epidp: Estimating Epidemiological Parameters Interest Using Covariate Information. R package version 0.0.0.9000, https://ben18785.github.io/epidp/.","code":"@Manual{,   title = {epidp: Estimating Epidemiological Parameters Of Interest Using Covariate Information},   author = {Ben Lambert and Kris Parag},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://ben18785.github.io/epidp/}, }"},{"path":"https://ben18785.github.io/epidp/index.html","id":"epidp","dir":"","previous_headings":"","what":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"goal epidp allow covariate information inform estimates time-varying reproduction number, RtR_t.","code":""},{"path":"https://ben18785.github.io/epidp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"can install development version epidp GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"ben18785/epidp\")"},{"path":[]},{"path":"https://ben18785.github.io/epidp/index.html","id":"step-function-in-r_t","dir":"","previous_headings":"Example","what":"Step function in RtR_t","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"first generate case data assuming step function RtR_t.  now use Stan version EpiFilter estimate maximum posteriori estimates RtR_t overlay top actual values. Note, estimates uncertainty associated benefit estimation instantaneous. estimates close actual RtR_t values initial period case counts low.","code":"library(epidp) library(ggplot2) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(magrittr) library(purrr) #>  #> Attaching package: 'purrr' #> The following object is masked from 'package:magrittr': #>  #>     set_names library(tidyr) #>  #> Attaching package: 'tidyr' #> The following object is masked from 'package:magrittr': #>  #>     extract  rt_fun = function(t){   if(t <= 60)     R = 2   else if (t <= 90)     R = 0.5   else     R = 1   R }  # simulation parameters nt <- 200 mean_si <- 6.5 sd_si <- 4.03 i_0 <- 10  # data frame of outputs epidemic_df <- simulate_renewal_epidemic(rt_fun, nt, mean_si, sd_si, i_0)  # plot transform_factor <- 300 epidemic_df %>%   select(-c(w_dist, lambda_t)) %>%   mutate(R_t = R_t * transform_factor) %>%    pivot_longer(c(i_t, R_t)) %>%   ggplot(aes(x = t, y = value, colour = name)) +   geom_line() +   scale_y_continuous(     name = \"Incidence (i_t)\",     sec.axis = sec_axis(~ . / transform_factor, name = \"Reproduction Number (R_t)\")   ) +   labs(x = \"Time\") +   theme_minimal() +   scale_color_brewer(\"Series\", palette = \"Dark2\") # fit model fit <- fit_epifilter(   N=length(epidemic_df$i_t),   C=epidemic_df$i_t,   w=epidemic_df$w_dist,   is_sampling=FALSE,   as_vector=FALSE )  # plot R <- fit$par$R epidemic_df %>%    mutate(estimated=R) %>%    rename(true=R_t) %>%    select(t, estimated, true) %>%    pivot_longer(c(estimated, true)) %>%    ggplot(aes(x=t, y=value)) +   geom_line(aes(colour=name)) +   scale_color_brewer(\"R_t\", palette = \"Dark2\") +   ylab(\"R_t\") +   xlab(\"Time\") +   theme_minimal()"},{"path":"https://ben18785.github.io/epidp/index.html","id":"contributing-guidelines","dir":"","previous_headings":"","what":"Contributing guidelines","title":"Estimating Epidemiological Parameters Of Interest Using Covariate Information","text":"welcome contributions collaborators. , ask read contributing guidelines section.","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"Estimate time-varying reproduction number incidence data","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"","code":"fit_epifilter(N, C, w, is_sampling = TRUE, ...)"},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"N number data points C case counts w discretised serial interval is_sampling Boolean indicating sampling used (TRUE) optimisation (FALSE). Defaults TRUE ...","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the time-varying reproduction number from incidence data — fit_epifilter","text":"stanfit object","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"Estimate time-varying reproduction number incidence data using covariate data","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"","code":"fit_epifilter_covariates(N, C, w, X, ...)"},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"N number data points C case counts w discretised serial interval X matrix covariates (likely include first column 1s) dimensions N x (N_covariates + 1) ...","code":""},{"path":"https://ben18785.github.io/epidp/reference/fit_epifilter_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the time-varying reproduction number from incidence data using covariate data — fit_epifilter_covariates","text":"stanfit object","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"function generates discretized serial interval distribution based gamma distribution characterized specified mean standard deviation.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"","code":"generate_vector_serial(nt, mean_si, sd_si)"},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"nt integer specifying number time points (length distribution). mean_si numeric value representing mean serial interval distribution. sd_si numeric value representing standard deviation serial interval distribution.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"numeric vector length nt representing discretized serial interval distribution.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"serial interval distribution discretized using gamma distribution shape scale parameters derived specified mean standard deviation. discretization performed computing difference cumulative distribution function (CDF) gamma distribution successive integer time points.","code":""},{"path":"https://ben18785.github.io/epidp/reference/generate_vector_serial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a Discretized Serial Interval Distribution — generate_vector_serial","text":"","code":"if (FALSE) { # \\dontrun{ generate_vector_serial(10, 5, 2) } # }"},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"function simulates epidemic using renewal model based specified time-varying reproduction number (Rt), serial interval distribution characterized gamma distribution, initial number cases.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"","code":"simulate_renewal_epidemic(Rt_fun, nt, mean_si, sd_si, i_0, X = NULL)"},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"nt integer specifying number time points (duration epidemic simulation). mean_si numeric value representing mean serial interval distribution. sd_si numeric value representing standard deviation serial interval distribution. i_0 integer specifying initial number cases time point 1. X optional matrix covariates nt rows. rt_fun function takes vector time points returns vector reproduction numbers (Rt) corresponding time points.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"list containing following components: i_t numeric vector incidence new cases time point. lambda_t numeric vector total infectiousness time point. w_dist numeric vector discretized serial interval distribution. r_t numeric vector reproduction number (Rt) time point. t numeric vector time points 1 nt.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"renewal model common approach simulating spread infectious diseases. total infectiousness time point computed convolution past incidence serial interval distribution. incidence time point simulated Poisson random variable mean equal product total infectiousness time-varying reproduction number.","code":""},{"path":"https://ben18785.github.io/epidp/reference/simulate_renewal_epidemic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a Renewal Epidemic Model — simulate_renewal_epidemic","text":"","code":"if (FALSE) { # \\dontrun{ rt_fun <- function(t) { 1.5 * exp(-0.05 * t) } simulate_renewal_epidemic(rt_fun, 100, 5, 2, 10) } # }"}]
